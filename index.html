<html>
<head>
  <title>Clicker</title>
  <meta charset="utf-8">
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
  import {
    getAuth,
    createUserWithEmailAndPassword,
    signInWithEmailAndPassword
  } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-auth.js";
  import {
    getDatabase,
    ref,
    set,
    get,
    child,
    update
  } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-database.js";

  // === ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ Firebase ===
  const firebaseConfig = {
    apiKey: "AIzaSyAlYasR91o2zMvD3OYYNFHdoyAAvfkiK80",
    authDomain: "spaceclicker-78ef5.firebaseapp.com",
    projectId: "spaceclicker-78ef5",
    storageBucket: "spaceclicker-78ef5.appspot.com",
    messagingSenderId: "1007817982727",
    appId: "1:1007817982727:web:c653b6f656b017cbb73ba2",
    databaseURL: "https://spaceclicker-78ef5-default-rtdb.firebaseio.com"
  };

  // === Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Firebase ===
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getDatabase(app);

  let userData = null; // ÐšÑÑˆ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
  let currentUid = null; // UID Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ

  async function getUidByUsername(username) {
    const usernameRef = ref(db, 'usernames/' + username);
    const snapshot = await get(usernameRef);
    if (snapshot.exists()) {
      return snapshot.val();
    } else {
      return null;
    }
  }

  async function getUserByUsername(username) {
    const uid = await getUidByUsername(username);
    if (!uid) return null;
    const userRef = ref(db, 'users/' + uid);
    const snapshot = await get(userRef);
    if (snapshot.exists()) {
      return snapshot.val();
    } else {
      return null;
    }
  }

  function getCurrentUser() {
    if (isDemo) {
      return demoUser;
    }
    return userData;
  }

  // === Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ ===
  async function doRegister() {
    const username = document.getElementById("regUsername").value.trim();
    const password = document.getElementById("regPassword").value.trim();
    const t = translations[currentLanguage];

    if (!username || !password) {
      showMsg("registerMsg", t.enterUsernamePassword, false);
      return;
    }

    const email = `${username}@clicker.com`;
    try {
      const userCred = await createUserWithEmailAndPassword(auth, email, password);
      const uid = userCred.user.uid;
      await set(ref(db, "users/" + uid), {
        username,
        count: 0,
        money: 0,
        level: 0,
        createdAt: new Date().toISOString(),
        has_small_cookie: 0,
        equipped_small_cookie: 0,
        has_medium_cookie: 0,
        equipped_medium_cookie: 0,
        has_large_cookie: 0,
        equipped_large_cookie: 0,
        is_blocked: 0,
        achieved_100: 0,
        achieved_500: 0,
        achieved_1000: 0,
        achieved_3000: 0,
        achieved_5000: 0,
        achieved_10000: 0,
        active_quest: null,
        completed_quests: []
      });
      await set(ref(db, "usernames/" + username), uid);
      showMsg("registerMsg", t.registrationSuccess, true);
      showLogin();
    } catch (error) {
      showMsg("registerMsg", error.message, false);
      console.error(error);
    }
  }

  // === Ð’Ñ…Ð¾Ð´ ===
  async function doLogin() {
    const username = document.getElementById("loginUsername").value.trim();
    const password = document.getElementById("loginPassword").value.trim();
    const t = translations[currentLanguage];

    if (!username || !password) {
      showMsg("loginMsg", t.enterUsernamePassword, false);
      return;
    }

    const email = `${username}@clicker.com`;
    try {
      const userCred = await signInWithEmailAndPassword(auth, email, password);
      currentUid = userCred.user.uid;

      const snapshot = await get(child(ref(db), "users/" + currentUid));
      if (snapshot.exists()) {
        userData = snapshot.val();
        if (userData.is_blocked) {
          showBlocked();
          return;
        }
        currentUsername = userData.username;
        count = Number(userData.count) || 0;
        money = Number(userData.money) || 0;
        internal_level = userData.level || 0;
        showMsg("loginMsg", t.loginSuccess, true);
        setTimeout(showLoading, 800);
      } else {
        showMsg("loginMsg", t.userNotFound, false);
      }
    } catch (error) {
      showMsg("loginMsg", error.message, false);
      console.error(error);
    }
  }

  // === Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑÐ° ===
  async function increment() {
    if (isPaused) return;
    let multiplier = 1;
    if (userData.equipped_small_cookie) multiplier *= 1.5;
    if (userData.equipped_medium_cookie) multiplier *= 2;
    if (userData.equipped_large_cookie) multiplier *= 2.5;
    count += multiplier;
    internal_level += 1;
    if (userData.active_quest !== null) {
      questClicks += multiplier;
      checkQuestCompletion();
    }
    updateCounter();
    updateLevel();
    userData.count = count;
    userData.level = internal_level;
    checkAchievements(currentUsername);
    const user = auth.currentUser;
    if (user) {
      try {
        await update(ref(db, "users/" + user.uid), {
          count,
          money,
          level: internal_level
        });
      } catch (error) {
        console.error("ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ:", error);
      }
    }
  }

  // === Ð”ÐµÐ»Ð°ÐµÐ¼ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ð¼Ð¸ ===
  window.doRegister = doRegister;
  window.doLogin = doLogin;
  window.increment = increment;

  var currentUsername = '';
  var count = 0;
  var money = 0;
  var internal_level = 0;
  var isDemo = false;
  var demoUser = null;
  var demoTimerInterval = null;
  var demoTimeLeft = 180; // 3 minutes in seconds
  var isInfiniteDemo = false;
  var demoJustExpired = false;
  var questUpdateInterval = null;
  var isPaused = false;
  var pauseStartTime = null;
  var wasQuestActive = false;
  var wasDemoTimerActive = false;
  var keys = {};
  var currentLanguage = localStorage.getItem('language') || 'ru';

  var translations = {
    ru: {
      title: 'Clicker',
      enterKeyTitle: 'Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÐºÐ»ÑŽÑ‡ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶ÐµÐ½Ð¸Ñ',
      enterKeyPlaceholder: 'Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÐºÐ»ÑŽÑ‡',
      submitKeyButton: 'Ð’Ð²ÐµÑÑ‚Ð¸',
      exitKeyButton: 'Ð’Ñ‹Ð¹Ñ‚Ð¸',
      demoModeButton: 'Demo Mode',
      loginTitle: 'Ð’Ñ…Ð¾Ð´',
      usernamePlaceholder: 'Ð˜Ð¼Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ',
      passwordPlaceholder: 'ÐŸÐ°Ñ€Ð¾Ð»ÑŒ',
      loginButton: 'Ð’Ð¾Ð¹Ñ‚Ð¸',
      noAccountText: 'ÐÐµÑ‚ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð°?',
      registerLink: 'Ð—Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒÑÑ',
      registerTitle: 'Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ',
      registerButton: 'Ð—Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒÑÑ',
      backButton: 'ÐÐ°Ð·Ð°Ð´',
      loadingText: 'Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° ÐºÐ»Ð¸ÐºÐµÑ€Ð°',
      shopButton: 'ÐœÐ°Ð³Ð°Ð·Ð¸Ð½',
      inventoryButton: 'Ð˜Ð½Ð²ÐµÐ½Ñ‚Ð°Ñ€ÑŒ',
      questsButton: 'Ð—Ð°Ð´Ð°Ð½Ð¸Ñ',
      level: 'Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ: ',
      counter: 'ÐÐ°ÐºÐ»Ð¸ÐºÐ°Ð½Ð¾: ',
      money: 'Ð”ÐµÐ½ÑŒÐ³Ð¸: ',
      clickButton: 'ÐšÐ»Ð¸Ðº',
      achievementsButton: 'Ð”Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ñ',
      promoButton: 'ÐŸÑ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´Ñ‹',
      exitButton: 'Ð’Ñ‹Ð¹Ñ‚Ð¸',
      currentQuestNone: 'Ð¢ÐµÐºÑƒÑ‰ÐµÐµ Ð·Ð°Ð´Ð°Ð½Ð¸Ðµ: Ð½ÐµÑ‚',
      pauseTitle: 'ÐŸÐ°ÑƒÐ·Ð°',
      resumeButton: 'ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÑŒ',
      settingsButton: 'ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸',
      logoutButton: 'Ð’Ñ‹Ð¹Ñ‚Ð¸',
      keyNoDate: 'ÐšÐ»ÑŽÑ‡ Ð´Ð»Ñ ÑÐµÐ³Ð¾Ð´Ð½ÑÑˆÐ½ÐµÐ³Ð¾ Ð´Ð½Ñ Ð½Ðµ Ð·Ð°Ð´Ð°Ð½.',
      keyIncorrect: 'ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡.',
      keyCorrect: 'ÐšÐ»ÑŽÑ‡ Ð²ÐµÑ€Ð½Ñ‹Ð¹ â€” Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ñ€Ð°Ð·Ñ€ÐµÑˆÑ‘Ð½.',
      enterUsernamePassword: 'Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¸Ð¼Ñ Ð¸ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ',
      invalidUsernamePassword: 'ÐÐµÐ²ÐµÑ€Ð½Ð¾Ðµ Ð¸Ð¼Ñ Ð¸Ð»Ð¸ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ',
      userExists: 'ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ ÑƒÐ¶Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚',
      registrationSuccess: 'Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ ÑƒÑÐ¿ÐµÑˆÐ½Ð°!',
      loginSuccess: 'Ð£ÑÐ¿ÐµÑˆÐ½Ñ‹Ð¹ Ð²Ñ…Ð¾Ð´!',
      shopTitle: 'ÐœÐ°Ð³Ð°Ð·Ð¸Ð½',
      smallCookie: 'Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐ°Ñ Ð¿ÐµÑ‡ÐµÐ½ÑŒÐºÐ°',
      mediumCookie: 'Ð¡Ñ€ÐµÐ´Ð½ÑÑ ÐŸÐµÑ‡ÐµÐ½ÑŒÐºÐ°',
      largeCookie: 'Ð‘Ð¾Ð»ÑŒÑˆÐ°Ñ ÐŸÐµÑ‡ÐµÐ½ÑŒÐºÐ°',
      buy: 'ÐšÑƒÐ¿Ð¸Ñ‚ÑŒ',
      bought: '(ÐšÑƒÐ¿Ð»ÐµÐ½Ð¾)',
      close: 'Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ',
      notEnoughClicks: 'ÐÐµÐ´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ ÐºÐ»Ð¸ÐºÐ¾Ð²!',
      boughtSuccess: 'ÐšÑƒÐ¿Ð»ÐµÐ½Ð¾!',
      inventoryTitle: 'Ð˜Ð½Ð²ÐµÐ½Ñ‚Ð°Ñ€ÑŒ',
      equipped: ' - Ð­ÐºÐ¸Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾',
      unequip: 'Ð¡Ð½ÑÑ‚ÑŒ',
      equip: 'Ð­ÐºÐ¸Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ',
      inventoryEmpty: 'Ð’Ð°Ñˆ Ð¸Ð½Ð²ÐµÐ½Ñ‚Ð°Ñ€ÑŒ Ð¿ÑƒÑÑ‚!',
      adminPanelTitle: 'ÐÐ´Ð¼Ð¸Ð½ ÐŸÐ°Ð½ÐµÐ»ÑŒ',
      targetUsernamePlaceholder: 'Ð˜Ð¼Ñ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð°',
      issueClicks: 'Ð’Ñ‹Ð´Ð°Ñ‚ÑŒ ÐºÐ»Ð¸ÐºÐ¸',
      issueCookie: 'Ð’Ñ‹Ð´Ð°Ñ‚ÑŒ Ð¿ÐµÑ‡ÐµÐ½ÑŒÐºÑƒ',
      issueAchievement: 'Ð’Ñ‹Ð´Ð°Ñ‚ÑŒ Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ðµ',
      block: 'Ð—Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ',
      unblock: 'Ð Ð°Ð·Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ',
      resetClicks: 'Ð¡Ð±Ñ€Ð¾ÑÐ¸Ñ‚ÑŒ ÐºÐ»Ð¸ÐºÐ¸',
      issueClicksTitle: 'Ð’Ñ‹Ð´Ð°Ñ‚ÑŒ ÐºÐ»Ð¸ÐºÐ¸',
      clickAmountPlaceholder: 'ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÐºÐ»Ð¸ÐºÐ¾Ð²',
      issue: 'Ð’Ñ‹Ð´Ð°Ñ‚ÑŒ',
      invalidAmount: 'ÐÐµÐ²ÐµÑ€Ð½Ð¾Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾!',
      issuedClicks: 'Ð’Ñ‹Ð´Ð°Ð½Ð¾ {amount} ÐºÐ»Ð¸ÐºÐ¾Ð² Ð´Ð»Ñ {target}',
      issueCookieTitle: 'Ð’Ñ‹Ð´Ð°Ñ‚ÑŒ Ð¿ÐµÑ‡ÐµÐ½ÑŒÐºÑƒ',
      small: 'ÐœÐ°Ð»ÐµÐ½ÑŒÐºÑƒÑŽ',
      medium: 'Ð¡Ñ€ÐµÐ´Ð½ÑŽÑŽ',
      large: 'Ð‘Ð¾Ð»ÑŒÑˆÑƒÑŽ',
      issuedCookieSmall: 'Ð”Ð°Ð½Ð° Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐ°Ñ Ð¿ÐµÑ‡ÐµÐ½ÑŒÐºÐ° Ð´Ð»Ñ {target}',
      issuedCookieMedium: 'Ð”Ð°Ð½Ð° ÑÑ€ÐµÐ´Ð½ÑÑ Ð¿ÐµÑ‡ÐµÐ½ÑŒÐºÐ° Ð´Ð»Ñ {target}',
      issuedCookieLarge: 'Ð”Ð°Ð½Ð° Ð±Ð¾Ð»ÑŒÑˆÐ°Ñ Ð¿ÐµÑ‡ÐµÐ½ÑŒÐºÐ° Ð´Ð»Ñ {target}',
      issueAchievementTitle: 'Ð’Ñ‹Ð´Ð°Ñ‚ÑŒ Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ðµ',
      achievement100: '100',
      achievement500: 'ÐŸÑÑ‚Ð¸Ñ…Ð°Ñ‚ÐºÐ°',
      achievement1000: 'ÐšÐ¾ÑÐ°Ñ€ÑŒ',
      achievement3000: '3 ÐºÐ¾Ð½ÑƒÑÐ°',
      achievement5000: 'ÐŸÑÑ‚Ñ‘Ñ€Ð¸Ðº',
      achievement10000: 'Ð£ Ñ‚ÐµÐ±Ñ Ð½ÐµÑ€Ð²Ñ‹ Ð¶ÐµÐ»ÐµÐ·Ð½Ñ‹Ðµ?',
      issuedAchievement: 'Ð”Ð°Ð½Ð¾ Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ðµ {name} Ð´Ð»Ñ {target}',
      blocked: 'ÐÐºÐºÐ°ÑƒÐ½Ñ‚ {target} Ð·Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½',
      unblocked: 'ÐÐºÐºÐ°ÑƒÐ½Ñ‚ {target} Ñ€Ð°Ð·Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½',
      clicksReset: 'ÐšÐ»Ð¸ÐºÐ¸ ÑÐ±Ñ€Ð¾ÑˆÐµÐ½Ñ‹ Ð´Ð»Ñ {target}',
      enterUsername: 'Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¸Ð¼Ñ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð°!',
      userNotFound: 'ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½!',
      blockedTitle: 'Ð‘Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ° Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð°',
      blockedText: 'Ð’Ð°Ñˆ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚ Ð±Ñ‹Ð» Ð·Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½ ÐÐ´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð¾Ð¼',
      userNotFoundAlert: 'ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½!',
      demoLabel: 'Demo Mode',
      demoTimer: 'ÐžÑÑ‚Ð°Ð²ÑˆÐµÐµÑÑ Ð²Ñ€ÐµÐ¼Ñ: ',
      demoExpiredTitle: 'Ð’Ñ€ÐµÐ¼Ñ Ð¸ÑÑ‚ÐµÐºÐ»Ð¾',
      demoExpiredText: 'Ð’Ñ€ÐµÐ¼Ñ Ð¿Ñ€Ð¾Ð±Ð½Ð¾Ð³Ð¾ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¾ÐºÐ¾Ð½Ñ‡ÐµÐ½Ð¾',
      ok: 'ÐžÐº',
      achievementsTitle: 'Ð”Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ñ',
      achieved: 'ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¾',
      notAchieved: 'ÐÐµ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¾',
      achievement100Desc: '100 (Ð´Ð¾ÑÑ‚Ð¸Ð³Ð½ÑƒÑ‚ÑŒ 100 ÐºÐ»Ð¸ÐºÐ¾Ð²): ',
      achievement500Desc: 'ÐŸÑÑ‚Ð¸Ñ…Ð°Ñ‚ÐºÐ° (Ð´Ð¾ÑÑ‚Ð¸Ð³Ð½ÑƒÑ‚ÑŒ 500 ÐºÐ»Ð¸ÐºÐ¾Ð²): ',
      achievement1000Desc: 'ÐšÐ¾ÑÐ°Ñ€ÑŒ (Ð´Ð¾ÑÑ‚Ð¸Ð³Ð½ÑƒÑ‚ÑŒ 1000 ÐºÐ»Ð¸ÐºÐ¾Ð²): ',
      achievement3000Desc: '3 ÐºÐ¾Ð½ÑƒÑÐ° (Ð´Ð¾ÑÑ‚Ð¸Ð³Ð½ÑƒÑ‚ÑŒ 3000 ÐºÐ»Ð¸ÐºÐ¾Ð²): ',
      achievement5000Desc: 'ÐŸÑÑ‚Ñ‘Ñ€Ð¸Ðº (Ð´Ð¾ÑÑ‚Ð¸Ð³Ð½ÑƒÑ‚ÑŒ 5000 ÐºÐ»Ð¸ÐºÐ¾Ð²): ',
      achievement10000Desc: 'Ð£ Ñ‚ÐµÐ±Ñ Ð½ÐµÑ€Ð²Ñ‹ Ð¶ÐµÐ»ÐµÐ·Ð½Ñ‹Ðµ? (Ð´Ð¾ÑÑ‚Ð¸Ð³Ð½ÑƒÑ‚ÑŒ 10000 ÐºÐ»Ð¸ÐºÐ¾Ð²): ',
      promoTitle: 'ÐŸÑ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´Ñ‹',
      promoPlaceholder: 'Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¿Ñ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´',
      redeem: 'Ð’Ð²ÐµÑÑ‚Ð¸',
      invalidPromo: 'ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´!',
      promoSmallCookie: 'ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð° Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐ°Ñ Ð¿ÐµÑ‡ÐµÐ½ÑŒÐºÐ°!',
      promo100Clicks: 'ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¾ 100 ÐºÐ»Ð¸ÐºÐ¾Ð²!',
      promoLargeCookie: 'ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð° Ð±Ð¾Ð»ÑŒÑˆÐ°Ñ Ð¿ÐµÑ‡ÐµÐ½ÑŒÐºÐ°!',
      consoleTitle: 'ÐšÐ¾Ð½ÑÐ¾Ð»ÑŒ',
      consolePlaceholder: 'Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ',
      execute: 'Ð’Ð²ÐµÑÑ‚Ð¸',
      enterCommand: 'Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ!',
      invalidCommand: 'ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð°Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°: {command}',
      setClicksSuccess: 'ÐšÐ»Ð¸ÐºÐ¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹ Ð½Ð° {amount}',
      invalidNumber: 'ÐÐµÐ²ÐµÑ€Ð½Ð¾Ðµ Ñ‡Ð¸ÑÐ»Ð¾ Ð² ÐºÐ¾Ð¼Ð°Ð½Ð´Ðµ!',
      invalidFormat: 'ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹! Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ {format}',
      gaveSmallCookie: 'ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð° Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐ°Ñ Ð¿ÐµÑ‡ÐµÐ½ÑŒÐºÐ°!',
      gaveMediumCookie: 'ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð° ÑÑ€ÐµÐ´Ð½ÑÑ Ð¿ÐµÑ‡ÐµÐ½ÑŒÐºÐ°!',
      gaveLargeCookie: 'ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð° Ð±Ð¾Ð»ÑŒÑˆÐ°Ñ Ð¿ÐµÑ‡ÐµÐ½ÑŒÐºÐ°!',
      notInDemo: 'Ð’Ñ‹ Ð½Ðµ Ð² Demo Mode!',
      exitDemo: 'Ð’Ñ‹Ñ…Ð¾Ð´ Ð¸Ð· Demo Mode',
      notInKeyMenu: 'ÐÐµ Ð² Ð¼ÐµÐ½ÑŽ Ñ ÐºÐ»ÑŽÑ‡Ð°Ð¼Ð¸!',
      autoPassKey: 'Auto passing key to registration',
      invalidTimeFormat: 'ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸!',
      demoTimeSet: 'Demo time set to {time}',
      demoTimeInfinity: 'Demo time set to infinity',
      questsTitle: 'Ð—Ð°Ð´Ð°Ð½Ð¸Ñ',
      questCompleted: 'âœ…',
      questNotCompleted: 'âŒ',
      takeQuest: 'Ð’Ð·ÑÑ‚ÑŒ',
      cancelQuest: 'Ð¡Ð½ÑÑ‚ÑŒ',
      activeQuest: 'Ð£ Ð²Ð°Ñ ÑƒÐ¶Ðµ ÐµÑÑ‚ÑŒ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾Ðµ Ð·Ð°Ð´Ð°Ð½Ð¸Ðµ!',
      questCancelled: 'Ð—Ð°Ð´Ð°Ð½Ð¸Ðµ Ð¾Ñ‚Ð¼ÐµÐ½ÐµÐ½Ð¾!',
      questTimeExpired: 'Ð’Ñ€ÐµÐ¼Ñ Ð½Ð° Ð·Ð°Ð´Ð°Ð½Ð¸Ðµ Ð¸ÑÑ‚ÐµÐºÐ»Ð¾! Ð—Ð°Ð´Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾Ð²Ð°Ð»ÐµÐ½Ð¾.',
      questCompletedSuccess: 'Ð—Ð°Ð´Ð°Ð½Ð¸Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¾! ÐÐ°Ð³Ñ€Ð°Ð´Ð°: {reward} Ð´ÐµÐ½ÐµÐ³.',
      currentQuest: 'Ð¢ÐµÐºÑƒÑ‰ÐµÐµ Ð·Ð°Ð´Ð°Ð½Ð¸Ðµ: Ð½Ð°ÐºÐ»Ð¸ÐºÐ°Ñ‚ÑŒ {clicks}/{required} ÐºÐ»Ð¸ÐºÐ¾Ð² Ð·Ð° {remaining} ÑÐµÐºÑƒÐ½Ð´',
      settingsTitle: 'ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸',
      uiScaleLabel: 'Ð Ð°Ð·Ð¼ÐµÑ€ Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹ÑÐ°:',
      smallScale: 'ÐœÐ°Ð»ÐµÐ½ÑŒÐºÐ¸Ð¹',
      mediumScale: 'Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹',
      largeScale: 'Ð‘Ð¾Ð»ÑŒÑˆÐ¾Ð¹',
      languageLabel: 'Ð¯Ð·Ñ‹Ðº:',
      russian: 'Ð ÑƒÑÑÐºÐ¸Ð¹',
      english: 'English',
      ukrainian: 'Ð£ÐºÑ€Ð°Ñ—Ð½ÑÑŒÐºÐ°',
      apply: 'ÐŸÑ€Ð¸Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ',
      achievementUnlocked: 'Ð”Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ñ€Ð°Ð·Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¾: {name}\nÐŸÐ¾Ð·Ð´Ñ€Ð°Ð²Ð»ÑÐµÐ¼! Ð’Ñ‹ Ð´Ð¾ÑÑ‚Ð¸Ð³Ð»Ð¸ {amount} ÐºÐ»Ð¸ÐºÐ¾Ð².',
      promoDisabledInDemo: 'ÐŸÑ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´Ñ‹ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹ Ð² Demo Mode',
      demoTimerInfinity: 'ÐžÑÑ‚Ð°Ð²ÑˆÐµÐµÑÑ Ð²Ñ€ÐµÐ¼Ñ: Infinity',
      questDescTemplate: 'Ð½Ð°ÐºÐ»Ð¸ÐºÐ°Ñ‚ÑŒ {required} ÐºÐ»Ð¸ÐºÐ¾Ð² Ð·Ð° {time} ÑÐµÐºÑƒÐ½Ð´'
    },
    en: {
      title: 'Clicker',
      enterKeyTitle: 'Enter key to continue',
      enterKeyPlaceholder: 'Enter key',
      submitKeyButton: 'Submit',
      exitKeyButton: 'Exit',
      demoModeButton: 'Demo Mode',
      loginTitle: 'Login',
      usernamePlaceholder: 'Username',
      passwordPlaceholder: 'Password',
      loginButton: 'Login',
      noAccountText: 'No account?',
      registerLink: 'Register',
      registerTitle: 'Registration',
      registerButton: 'Register',
      backButton: 'Back',
      loadingText: 'Loading clicker',
      shopButton: 'Shop',
      inventoryButton: 'Inventory',
      questsButton: 'Quests',
      level: 'Level: ',
      counter: 'Clicks: ',
      money: 'Money: ',
      clickButton: 'Click',
      achievementsButton: 'Achievements',
      promoButton: 'Promo codes',
      exitButton: 'Logout',
      currentQuestNone: 'Current quest: none',
      pauseTitle: 'Pause',
      resumeButton: 'Resume',
      settingsButton: 'Settings',
      logoutButton: 'Logout',
      keyNoDate: 'Key for today is not set.',
      keyIncorrect: 'Invalid key.',
      keyCorrect: 'Key is correct â€” access granted.',
      enterUsernamePassword: 'Enter username and password',
      invalidUsernamePassword: 'Invalid username or password',
      userExists: 'User already exists',
      registrationSuccess: 'Registration successful!',
      loginSuccess: 'Successful login!',
      shopTitle: 'Shop',
      smallCookie: 'small cookie',
      mediumCookie: 'Medium Cookie',
      largeCookie: 'Large Cookie',
      buy: 'Buy',
      bought: '(Bought)',
      close: 'Close',
      notEnoughClicks: 'Not enough clicks!',
      boughtSuccess: 'Bought!',
      inventoryTitle: 'Inventory',
      equipped: ' - Equipped',
      unequip: 'Unequip',
      equip: 'Equip',
      inventoryEmpty: 'Your inventory is empty!',
      adminPanelTitle: 'Admin Panel',
      targetUsernamePlaceholder: 'Account name',
      issueClicks: 'Issue clicks',
      issueCookie: 'Issue cookie',
      issueAchievement: 'Issue achievement',
      block: 'Block',
      unblock: 'Unblock',
      resetClicks: 'Reset clicks',
      issueClicksTitle: 'Issue clicks',
      clickAmountPlaceholder: 'Number of clicks',
      issue: 'Issue',
      invalidAmount: 'Invalid amount!',
      issuedClicks: 'Issued {amount} clicks to {target}',
      issueCookieTitle: 'Issue cookie',
      small: 'Small',
      medium: 'Medium',
      large: 'Large',
      issuedCookieSmall: 'Issued small cookie to {target}',
      issuedCookieMedium: 'Issued medium cookie to {target}',
      issuedCookieLarge: 'Issued large cookie to {target}',
      issueAchievementTitle: 'Issue achievement',
      achievement100: '100',
      achievement500: 'Five hundred',
      achievement1000: 'Thousand',
      achievement3000: '3 cones',
      achievement5000: 'Five grand',
      achievement10000: 'Do you have iron nerves?',
      issuedAchievement: 'Issued achievement {name} to {target}',
      blocked: 'Account {target} blocked',
      unblocked: 'Account {target} unblocked',
      clicksReset: 'Clicks reset for {target}',
      enterUsername: 'Enter account name!',
      userNotFound: 'User not found!',
      blockedTitle: 'Account Blocked',
      blockedText: 'Your account has been blocked by the Administrator',
      userNotFoundAlert: 'User not found!',
      demoLabel: 'Demo Mode',
      demoTimer: 'Time left: ',
      demoExpiredTitle: 'Time Expired',
      demoExpiredText: 'Trial testing time is over',
      ok: 'Ok',
      achievementsTitle: 'Achievements',
      achieved: 'Achieved',
      notAchieved: 'Not achieved',
      achievement100Desc: '100 (reach 100 clicks): ',
      achievement500Desc: 'Five hundred (reach 500 clicks): ',
      achievement1000Desc: 'Thousand (reach 1000 clicks): ',
      achievement3000Desc: '3 cones (reach 3000 clicks): ',
      achievement5000Desc: 'Five grand (reach 5000 clicks): ',
      achievement10000Desc: 'Do you have iron nerves? (reach 10000 clicks): ',
      promoTitle: 'Promo codes',
      promoPlaceholder: 'Enter promo code',
      redeem: 'Redeem',
      invalidPromo: 'Invalid promo code!',
      promoSmallCookie: 'Received small cookie!',
      promo100Clicks: 'Received 100 clicks!',
      promoLargeCookie: 'Received large cookie!',
      consoleTitle: 'Console',
      consolePlaceholder: 'Enter command',
      execute: 'Execute',
      enterCommand: 'Enter command!',
      invalidCommand: 'Unknown command: {command}',
      setClicksSuccess: 'Clicks set to {amount}',
      invalidNumber: 'Invalid number in command!',
      invalidFormat: 'Invalid command format! Use {format}',
      gaveSmallCookie: 'Received small cookie!',
      gaveMediumCookie: 'Received medium cookie!',
      gaveLargeCookie: 'Received large cookie!',
      notInDemo: 'You are not in Demo Mode!',
      exitDemo: 'Exiting Demo Mode',
      notInKeyMenu: 'Not in key menu!',
      autoPassKey: 'Auto passing key to registration',
      invalidTimeFormat: 'Invalid time format!',
      demoTimeSet: 'Demo time set to {time}',
      demoTimeInfinity: 'Demo time set to infinity',
      questsTitle: 'Quests',
      questCompleted: 'âœ…',
      questNotCompleted: 'âŒ',
      takeQuest: 'Take',
      cancelQuest: 'Cancel',
      activeQuest: 'You already have an active quest!',
      questCancelled: 'Quest cancelled!',
      questTimeExpired: 'Quest time expired! Quest failed.',
      questCompletedSuccess: 'Quest completed! Reward: {reward} money.',
      currentQuest: 'Current quest: click {clicks}/{required} clicks in {remaining} seconds',
      settingsTitle: 'Settings',
      uiScaleLabel: 'UI Scale:',
      smallScale: 'Small',
      mediumScale: 'Medium',
      largeScale: 'Large',
      languageLabel: 'Language:',
      russian: 'Russian',
      english: 'English',
      ukrainian: 'Ukrainian',
      apply: 'Apply',
      achievementUnlocked: 'Achievement unlocked: {name}\nCongratulations! You reached {amount} clicks.',
      promoDisabledInDemo: 'Promo codes are unavailable in Demo Mode',
      demoTimerInfinity: 'Time left: Infinity',
      questDescTemplate: 'reach {required} clicks in {time} seconds'
    },
    uk: {
      title: 'ÐšÐ»Ñ–ÐºÐµÑ€',
      enterKeyTitle: 'Ð’Ð²ÐµÐ´Ñ–Ñ‚ÑŒ ÐºÐ»ÑŽÑ‡ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð´Ð¾Ð²Ð¶ÐµÐ½Ð½Ñ',
      enterKeyPlaceholder: 'Ð’Ð²ÐµÐ´Ñ–Ñ‚ÑŒ ÐºÐ»ÑŽÑ‡',
      submitKeyButton: 'Ð’Ð²ÐµÑÑ‚Ð¸',
      exitKeyButton: 'Ð’Ð¸Ð¹Ñ‚Ð¸',
      demoModeButton: 'Demo Mode',
      loginTitle: 'Ð’Ñ…Ñ–Ð´',
      usernamePlaceholder: "Ð†Ð¼'Ñ ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡Ð°",
      passwordPlaceholder: 'ÐŸÐ°Ñ€Ð¾Ð»ÑŒ',
      loginButton: 'Ð£Ð²Ñ–Ð¹Ñ‚Ð¸',
      noAccountText: 'ÐÐµÐ¼Ð°Ñ” Ð¾Ð±Ð»Ñ–ÐºÐ¾Ð²Ð¾Ð³Ð¾ Ð·Ð°Ð¿Ð¸ÑÑƒ?',
      registerLink: 'Ð—Ð°Ñ€ÐµÑ”ÑÑ‚Ñ€ÑƒÐ²Ð°Ñ‚Ð¸ÑÑ',
      registerTitle: 'Ð ÐµÑ”ÑÑ‚Ñ€Ð°Ñ†Ñ–Ñ',
      registerButton: 'Ð—Ð°Ñ€ÐµÑ”ÑÑ‚Ñ€ÑƒÐ²Ð°Ñ‚Ð¸ÑÑ',
      backButton: 'ÐÐ°Ð·Ð°Ð´',
      loadingText: 'Ð—Ð°Ð²Ð°Ð½Ñ‚Ð°Ð¶ÐµÐ½Ð½Ñ ÐºÐ»Ñ–ÐºÐµÑ€Ð°',
      shopButton: 'ÐœÐ°Ð³Ð°Ð·Ð¸Ð½',
      inventoryButton: 'Ð†Ð½Ð²ÐµÐ½Ñ‚Ð°Ñ€',
      questsButton: 'Ð—Ð°Ð²Ð´Ð°Ð½Ð½Ñ',
      level: 'Ð Ñ–Ð²ÐµÐ½ÑŒ: ',
      counter: 'ÐÐ°ÐºÐ»Ñ–ÐºÐ°Ð½Ð¾: ',
      money: 'Ð“Ñ€Ð¾ÑˆÑ–: ',
      clickButton: 'ÐšÐ»Ñ–Ðº',
      achievementsButton: 'Ð”Ð¾ÑÑÐ³Ð½ÐµÐ½Ð½Ñ',
      promoButton: 'ÐŸÑ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´Ð¸',
      exitButton: 'Ð’Ð¸Ð¹Ñ‚Ð¸',
      currentQuestNone: 'ÐŸÐ¾Ñ‚Ð¾Ñ‡Ð½Ðµ Ð·Ð°Ð²Ð´Ð°Ð½Ð½Ñ: Ð½ÐµÐ¼Ð°Ñ”',
      pauseTitle: 'ÐŸÐ°ÑƒÐ·Ð°',
      resumeButton: 'ÐŸÑ€Ð¾Ð´Ð¾Ð²Ð¶Ð¸Ñ‚Ð¸',
      settingsButton: 'ÐÐ°Ð»Ð°ÑˆÑ‚ÑƒÐ²Ð°Ð½Ð½Ñ',
      logoutButton: 'Ð’Ð¸Ð¹Ñ‚Ð¸',
      keyNoDate: 'ÐšÐ»ÑŽÑ‡ Ð´Ð»Ñ ÑÑŒÐ¾Ð³Ð¾Ð´Ð½Ñ–ÑˆÐ½ÑŒÐ¾Ð³Ð¾ Ð´Ð½Ñ Ð½Ðµ Ð·Ð°Ð´Ð°Ð½Ð¾.',
      keyIncorrect: 'ÐÐµÐ²Ñ–Ñ€Ð½Ð¸Ð¹ ÐºÐ»ÑŽÑ‡.',
      keyCorrect: 'ÐšÐ»ÑŽÑ‡ Ð²Ñ–Ñ€Ð½Ð¸Ð¹ â€” Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ð´Ð¾Ð·Ð²Ð¾Ð»ÐµÐ½Ð¾.',
      enterUsernamePassword: "Ð’Ð²ÐµÐ´Ñ–Ñ‚ÑŒ Ñ–Ð¼'Ñ Ñ‚Ð° Ð¿Ð°Ñ€Ð¾Ð»ÑŒ",
      invalidUsernamePassword: "ÐÐµÐ²Ñ–Ñ€Ð½Ðµ Ñ–Ð¼'Ñ Ð°Ð±Ð¾ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ",
      userExists: 'ÐšÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡ Ð²Ð¶Ðµ Ñ–ÑÐ½ÑƒÑ”',
      registrationSuccess: 'Ð ÐµÑ”ÑÑ‚Ñ€Ð°Ñ†Ñ–Ñ ÑƒÑÐ¿Ñ–ÑˆÐ½Ð°!',
      loginSuccess: 'Ð£ÑÐ¿Ñ–ÑˆÐ½Ð¸Ð¹ Ð²Ñ…Ñ–Ð´!',
      shopTitle: 'ÐœÐ°Ð³Ð°Ð·Ð¸Ð½',
      smallCookie: 'Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐµ Ð¿ÐµÑ‡Ð¸Ð²Ð¾',
      mediumCookie: 'Ð¡ÐµÑ€ÐµÐ´Ð½Ñ” ÐŸÐµÑ‡Ð¸Ð²Ð¾',
      largeCookie: 'Ð’ÐµÐ»Ð¸ÐºÐµ ÐŸÐµÑ‡Ð¸Ð²Ð¾',
      buy: 'ÐšÑƒÐ¿Ð¸Ñ‚Ð¸',
      bought: '(ÐšÑƒÐ¿Ð»ÐµÐ½Ð¾)',
      close: 'Ð—Ð°ÐºÑ€Ð¸Ñ‚Ð¸',
      notEnoughClicks: 'ÐÐµÐ´Ð¾ÑÑ‚Ð°Ñ‚Ð½ÑŒÐ¾ ÐºÐ»Ñ–ÐºÑ–Ð²!',
      boughtSuccess: 'ÐšÑƒÐ¿Ð»ÐµÐ½Ð¾!',
      inventoryTitle: 'Ð†Ð½Ð²ÐµÐ½Ñ‚Ð°Ñ€',
      equipped: ' - Ð•ÐºÑ–Ð¿Ñ–Ñ€Ð¾Ð²Ð°Ð½Ð¾',
      unequip: 'Ð—Ð½ÑÑ‚Ð¸',
      equip: 'Ð•ÐºÑ–Ð¿Ñ–Ñ€ÑƒÐ²Ð°Ñ‚Ð¸',
      inventoryEmpty: 'Ð’Ð°Ñˆ Ñ–Ð½Ð²ÐµÐ½Ñ‚Ð°Ñ€ Ð¿Ð¾Ñ€Ð¾Ð¶Ð½Ñ–Ð¹!',
      adminPanelTitle: 'ÐÐ´Ð¼Ñ–Ð½ ÐŸÐ°Ð½ÐµÐ»ÑŒ',
      targetUsernamePlaceholder: "Ð†Ð¼'Ñ Ð¾Ð±Ð»Ñ–ÐºÐ¾Ð²Ð¾Ð³Ð¾ Ð·Ð°Ð¿Ð¸ÑÑƒ",
      issueClicks: 'Ð’Ð¸Ð´Ð°Ñ‚Ð¸ ÐºÐ»Ñ–ÐºÐ¸',
      issueCookie: 'Ð’Ð¸Ð´Ð°Ñ‚Ð¸ Ð¿ÐµÑ‡Ð¸Ð²Ð¾',
      issueAchievement: 'Ð’Ð¸Ð´Ð°Ñ‚Ð¸ Ð´Ð¾ÑÑÐ³Ð½ÐµÐ½Ð½Ñ',
      block: 'Ð—Ð°Ð±Ð»Ð¾ÐºÑƒÐ²Ð°Ñ‚Ð¸',
      unblock: 'Ð Ð¾Ð·Ð±Ð»Ð¾ÐºÑƒÐ²Ð°Ñ‚Ð¸',
      resetClicks: 'Ð¡ÐºÐ¸Ð½ÑƒÑ‚Ð¸ ÐºÐ»Ñ–ÐºÐ¸',
      issueClicksTitle: 'Ð’Ð¸Ð´Ð°Ñ‚Ð¸ ÐºÐ»Ñ–ÐºÐ¸',
      clickAmountPlaceholder: 'ÐšÑ–Ð»ÑŒÐºÑ–ÑÑ‚ÑŒ ÐºÐ»Ñ–ÐºÑ–Ð²',
      issue: 'Ð’Ð¸Ð´Ð°Ñ‚Ð¸',
      invalidAmount: 'ÐÐµÐ²Ñ–Ñ€Ð½Ð° ÐºÑ–Ð»ÑŒÐºÑ–ÑÑ‚ÑŒ!',
      issuedClicks: 'Ð’Ð¸Ð´Ð°Ð½Ð¾ {amount} ÐºÐ»Ñ–ÐºÑ–Ð² Ð´Ð»Ñ {target}',
      issueCookieTitle: 'Ð’Ð¸Ð´Ð°Ñ‚Ð¸ Ð¿ÐµÑ‡Ð¸Ð²Ð¾',
      small: 'ÐœÐ°Ð»ÐµÐ½ÑŒÐºÐµ',
      medium: 'Ð¡ÐµÑ€ÐµÐ´Ð½Ñ”',
      large: 'Ð’ÐµÐ»Ð¸ÐºÐµ',
      issuedCookieSmall: 'Ð’Ð¸Ð´Ð°Ð½Ð¾ Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐµ Ð¿ÐµÑ‡Ð¸Ð²Ð¾ Ð´Ð»Ñ {target}',
      issuedCookieMedium: 'Ð’Ð¸Ð´Ð°Ð½Ð¾ ÑÐµÑ€ÐµÐ´Ð½Ñ” Ð¿ÐµÑ‡Ð¸Ð²Ð¾ Ð´Ð»Ñ {target}',
      issuedCookieLarge: 'Ð’Ð¸Ð´Ð°Ð½Ð¾ Ð²ÐµÐ»Ð¸ÐºÐµ Ð¿ÐµÑ‡Ð¸Ð²Ð¾ Ð´Ð»Ñ {target}',
      issueAchievementTitle: 'Ð’Ð¸Ð´Ð°Ñ‚Ð¸ Ð´Ð¾ÑÑÐ³Ð½ÐµÐ½Ð½Ñ',
      achievement100: '100',
      achievement500: 'ÐŸ\'ÑÑ‚Ð¸Ñ…Ð°Ñ‚ÐºÐ°',
      achievement1000: 'ÐšÐ¾ÑÐ°Ñ€',
      achievement3000: '3 ÐºÐ¾Ð½ÑƒÑÐ°',
      achievement5000: 'ÐŸ\'ÑÑ‚Ñ–Ñ€Ð¸Ðº',
      achievement10000: 'Ð£ Ñ‚ÐµÐ±Ðµ Ð½ÐµÑ€Ð²Ð¸ Ð·Ð°Ð»Ñ–Ð·Ð½Ñ–?',
      issuedAchievement: 'Ð’Ð¸Ð´Ð°Ð½Ð¾ Ð´Ð¾ÑÑÐ³Ð½ÐµÐ½Ð½Ñ {name} Ð´Ð»Ñ {target}',
      blocked: 'ÐžÐ±Ð»Ñ–ÐºÐ¾Ð²Ð¸Ð¹ Ð·Ð°Ð¿Ð¸Ñ {target} Ð·Ð°Ð±Ð»Ð¾ÐºÐ¾Ð²Ð°Ð½Ð¾',
      unblocked: 'ÐžÐ±Ð»Ñ–ÐºÐ¾Ð²Ð¸Ð¹ Ð·Ð°Ð¿Ð¸Ñ {target} Ñ€Ð¾Ð·Ð±Ð»Ð¾ÐºÐ¾Ð²Ð°Ð½Ð¾',
      clicksReset: 'ÐšÐ»Ñ–ÐºÐ¸ ÑÐºÐ¸Ð½ÑƒÑ‚Ð¾ Ð´Ð»Ñ {target}',
      enterUsername: "Ð’Ð²ÐµÐ´Ñ–Ñ‚ÑŒ Ñ–Ð¼'Ñ Ð¾Ð±Ð»Ñ–ÐºÐ¾Ð²Ð¾Ð³Ð¾ Ð·Ð°Ð¿Ð¸ÑÑƒ!",
      userNotFound: 'ÐšÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡ Ð½Ðµ Ð·Ð½Ð°Ð¹Ð´ÐµÐ½Ð¸Ð¹!',
      blockedTitle: 'Ð‘Ð»Ð¾ÐºÑƒÐ²Ð°Ð½Ð½Ñ Ð¾Ð±Ð»Ñ–ÐºÐ¾Ð²Ð¾Ð³Ð¾ Ð·Ð°Ð¿Ð¸ÑÑƒ',
      blockedText: 'Ð’Ð°Ñˆ Ð¾Ð±Ð»Ñ–ÐºÐ¾Ð²Ð¸Ð¹ Ð·Ð°Ð¿Ð¸Ñ Ð±ÑƒÐ»Ð¾ Ð·Ð°Ð±Ð»Ð¾ÐºÐ¾Ð²Ð°Ð½Ð¾ ÐÐ´Ð¼Ñ–Ð½Ñ–ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð¾Ð¼',
      userNotFoundAlert: 'ÐšÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡ Ð½Ðµ Ð·Ð½Ð°Ð¹Ð´ÐµÐ½Ð¸Ð¹!',
      demoLabel: 'Demo Mode',
      demoTimer: 'Ð—Ð°Ð»Ð¸ÑˆÐ¸Ð²ÑÑ Ñ‡Ð°Ñ: ',
      demoExpiredTitle: 'Ð§Ð°Ñ Ð¼Ð¸Ð½ÑƒÐ²',
      demoExpiredText: 'Ð§Ð°Ñ Ð¿Ñ€Ð¾Ð±Ð½Ð¾Ð³Ð¾ Ñ‚ÐµÑÑ‚ÑƒÐ²Ð°Ð½Ð½Ñ Ð·Ð°ÐºÑ–Ð½Ñ‡ÐµÐ½Ð¾',
      ok: 'ÐžÐº',
      achievementsTitle: 'Ð”Ð¾ÑÑÐ³Ð½ÐµÐ½Ð½Ñ',
      achieved: 'ÐžÑ‚Ñ€Ð¸Ð¼Ð°Ð½Ð¾',
      notAchieved: 'ÐÐµ Ð¾Ñ‚Ñ€Ð¸Ð¼Ð°Ð½Ð¾',
      achievement100Desc: '100 (Ð´Ð¾ÑÑÐ³Ñ‚Ð¸ 100 ÐºÐ»Ñ–ÐºÑ–Ð²): ',
      achievement500Desc: 'ÐŸ\'ÑÑ‚Ð¸Ñ…Ð°Ñ‚ÐºÐ° (Ð´Ð¾ÑÑÐ³Ñ‚Ð¸ 500 ÐºÐ»Ñ–ÐºÑ–Ð²): ',
      achievement1000Desc: 'ÐšÐ¾ÑÐ°Ñ€ (Ð´Ð¾ÑÑÐ³Ñ‚Ð¸ 1000 ÐºÐ»Ñ–ÐºÑ–Ð²): ',
      achievement3000Desc: '3 ÐºÐ¾Ð½ÑƒÑÐ° (Ð´Ð¾ÑÑÐ³Ñ‚Ð¸ 3000 ÐºÐ»Ñ–ÐºÑ–Ð²): ',
      achievement5000Desc: 'ÐŸ\'ÑÑ‚Ñ–Ñ€Ð¸Ðº (Ð´Ð¾ÑÑÐ³Ñ‚Ð¸ 5000 ÐºÐ»Ñ–ÐºÑ–Ð²): ',
      achievement10000Desc: 'Ð£ Ñ‚ÐµÐ±Ðµ Ð½ÐµÑ€Ð²Ð¸ Ð·Ð°Ð»Ñ–Ð·Ð½Ñ–? (Ð´Ð¾ÑÑÐ³Ñ‚Ð¸ 10000 ÐºÐ»Ñ–ÐºÑ–Ð²): ',
      promoTitle: 'ÐŸÑ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´Ð¸',
      promoPlaceholder: 'Ð’Ð²ÐµÐ´Ñ–Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´',
      redeem: 'Ð’Ð²ÐµÑÑ‚Ð¸',
      invalidPromo: 'ÐÐµÐ²Ñ–Ñ€Ð½Ð¸Ð¹ Ð¿Ñ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´!',
      promoSmallCookie: 'ÐžÑ‚Ñ€Ð¸Ð¼Ð°Ð½Ð¾ Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐµ Ð¿ÐµÑ‡Ð¸Ð²Ð¾!',
      promo100Clicks: 'ÐžÑ‚Ñ€Ð¸Ð¼Ð°Ð½Ð¾ 100 ÐºÐ»Ñ–ÐºÑ–Ð²!',
      promoLargeCookie: 'ÐžÑ‚Ñ€Ð¸Ð¼Ð°Ð½Ð¾ Ð²ÐµÐ»Ð¸ÐºÐµ Ð¿ÐµÑ‡Ð¸Ð²Ð¾!',
      consoleTitle: 'ÐšÐ¾Ð½ÑÐ¾Ð»ÑŒ',
      consolePlaceholder: 'Ð’Ð²ÐµÐ´Ñ–Ñ‚ÑŒ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ',
      execute: 'Ð’Ð²ÐµÑÑ‚Ð¸',
      enterCommand: 'Ð’Ð²ÐµÐ´Ñ–Ñ‚ÑŒ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ!',
      invalidCommand: 'ÐÐµÐ²Ñ–Ð´Ð¾Ð¼Ð° ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°: {command}',
      setClicksSuccess: 'ÐšÐ»Ñ–ÐºÐ¸ Ð²ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾ Ð½Ð° {amount}',
      invalidNumber: 'ÐÐµÐ²Ñ–Ñ€Ð½Ðµ Ñ‡Ð¸ÑÐ»Ð¾ Ð² ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ–!',
      invalidFormat: 'ÐÐµÐ²Ñ–Ñ€Ð½Ð¸Ð¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð¸! Ð’Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÐ¹Ñ‚Ðµ {format}',
      gaveSmallCookie: 'ÐžÑ‚Ñ€Ð¸Ð¼Ð°Ð½Ð¾ Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐµ Ð¿ÐµÑ‡Ð¸Ð²Ð¾!',
      gaveMediumCookie: 'ÐžÑ‚Ñ€Ð¸Ð¼Ð°Ð½Ð¾ ÑÐµÑ€ÐµÐ´Ð½Ñ” Ð¿ÐµÑ‡Ð¸Ð²Ð¾!',
      gaveLargeCookie: 'ÐžÑ‚Ñ€Ð¸Ð¼Ð°Ð½Ð¾ Ð²ÐµÐ»Ð¸ÐºÐµ Ð¿ÐµÑ‡Ð¸Ð²Ð¾!',
      notInDemo: 'Ð’Ð¸ Ð½Ðµ Ð² Demo Mode!',
      exitDemo: 'Ð’Ð¸Ñ…Ñ–Ð´ Ð· Demo Mode',
      notInKeyMenu: 'ÐÐµ Ð² Ð¼ÐµÐ½ÑŽ Ð· ÐºÐ»ÑŽÑ‡Ð°Ð¼Ð¸!',
      autoPassKey: 'Auto passing key to registration',
      invalidTimeFormat: 'ÐÐµÐ²Ñ–Ñ€Ð½Ð¸Ð¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ Ñ‡Ð°ÑÑƒ!',
      demoTimeSet: 'Demo time set to {time}',
      demoTimeInfinity: 'Demo time set to infinity',
      questsTitle: 'Ð—Ð°Ð²Ð´Ð°Ð½Ð½Ñ',
      questCompleted: 'âœ…',
      questNotCompleted: 'âŒ',
      takeQuest: 'Ð’Ð·ÑÑ‚Ð¸',
      cancelQuest: 'Ð—Ð½ÑÑ‚Ð¸',
      activeQuest: 'Ð£ Ð²Ð°Ñ Ð²Ð¶Ðµ Ñ” Ð°ÐºÑ‚Ð¸Ð²Ð½Ðµ Ð·Ð°Ð²Ð´Ð°Ð½Ð½Ñ!',
      questCancelled: 'Ð—Ð°Ð²Ð´Ð°Ð½Ð½Ñ ÑÐºÐ°ÑÐ¾Ð²Ð°Ð½Ð¾!',
      questTimeExpired: 'Ð§Ð°Ñ Ð½Ð° Ð·Ð°Ð²Ð´Ð°Ð½Ð½Ñ Ð¼Ð¸Ð½ÑƒÐ²! Ð—Ð°Ð²Ð´Ð°Ð½Ð½Ñ Ð¿Ñ€Ð¾Ð²Ð°Ð»ÐµÐ½Ð¾.',
      questCompletedSuccess: 'Ð—Ð°Ð²Ð´Ð°Ð½Ð½Ñ Ð²Ð¸ÐºÐ¾Ð½Ð°Ð½Ð¾! ÐÐ°Ð³Ð¾Ñ€Ð¾Ð´Ð°: {reward} Ð³Ñ€Ð¾ÑˆÐµÐ¹.',
      currentQuest: 'ÐŸÐ¾Ñ‚Ð¾Ñ‡Ð½Ðµ Ð·Ð°Ð²Ð´Ð°Ð½Ð½Ñ: Ð½Ð°ÐºÐ»Ñ–ÐºÐ°Ñ‚Ð¸ {clicks}/{required} ÐºÐ»Ñ–ÐºÑ–Ð² Ð·Ð° {remaining} ÑÐµÐºÑƒÐ½Ð´',
      settingsTitle: 'ÐÐ°Ð»Ð°ÑˆÑ‚ÑƒÐ²Ð°Ð½Ð½Ñ',
      uiScaleLabel: 'Ð Ð¾Ð·Ð¼Ñ–Ñ€ Ñ–Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹ÑÑƒ:',
      smallScale: 'ÐœÐ°Ð»ÐµÐ½ÑŒÐºÐ¸Ð¹',
      mediumScale: 'Ð¡ÐµÑ€ÐµÐ´Ð½Ñ–Ð¹',
      largeScale: 'Ð’ÐµÐ»Ð¸ÐºÐ¸Ð¹',
      languageLabel: 'ÐœÐ¾Ð²Ð°:',
      russian: 'Ð Ð¾ÑÑ–Ð¹ÑÑŒÐºÐ°',
      english: 'ÐÐ½Ð³Ð»Ñ–Ð¹ÑÑŒÐºÐ°',
      ukrainian: 'Ð£ÐºÑ€Ð°Ñ—Ð½ÑÑŒÐºÐ°',
      apply: 'Ð—Ð°ÑÑ‚Ð¾ÑÑƒÐ²Ð°Ñ‚Ð¸',
      achievementUnlocked: 'Ð”Ð¾ÑÑÐ³Ð½ÐµÐ½Ð½Ñ Ñ€Ð¾Ð·Ð±Ð»Ð¾ÐºÐ¾Ð²Ð°Ð½Ð¾: {name}\nÐ’Ñ–Ñ‚Ð°Ñ”Ð¼Ð¾! Ð’Ð¸ Ð´Ð¾ÑÑÐ³Ð»Ð¸ {amount} ÐºÐ»Ñ–ÐºÑ–Ð².',
      promoDisabledInDemo: 'ÐŸÑ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´Ð¸ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ– Ð² Demo Mode',
      demoTimerInfinity: 'Ð—Ð°Ð»Ð¸ÑˆÐ¸Ð²ÑÑ Ñ‡Ð°Ñ: Infinity',
      questDescTemplate: 'Ð´Ð¾ÑÑÐ³Ñ‚Ð¸ {required} ÐºÐ»Ñ–ÐºÑ–Ð² Ð·Ð° {time} ÑÐµÐºÑƒÐ½Ð´'
    }
  };

  function init() {
    var storedKeys = localStorage.getItem('clickerKeys');
    if (storedKeys) {
      keys = JSON.parse(storedKeys);
    } else {
var encoded_keys = {
  // ðŸ”¹ Ð¡Ñ‚Ð°Ñ€Ñ‹Ðµ ÐºÐ»ÑŽÑ‡Ð¸
  '2025-10-01': 'TFlTVUtBLUtPVC0x',        // LYSUKA-KOT-1
  '2025-10-02': 'TFlTVUtBLUtPVC0xMjM=',     // LYSUKA-KOT-123
  '2025-10-03': 'TFlTVUtBLUtPVC0xMjM0',     // LYSUKA-KOT-1234
  '2025-10-04': 'TFlTVUtBLUtPVC0xMjM1',     // LYSUKA-KOT-1235
  '2025-10-05': 'TFlTVUtBLUtPVC0xMjQz',     // LYSUKA-KOT-1243
  '2025-10-06': 'TFlTVUtBLUtPVC01NDMyMQ==', // LYSUKA-KOT-54321
  '2025-10-07': 'TFlTVUtBLUtPVC00NTc2',     // LYSUKA-KOT-4576
  '2025-10-08': 'TFlTVUtBLUtPVC04Mzc0',     // LYSUKA-KOT-8374
  '2025-10-09': 'TFlTVUtBLUtPVC05MTM1',     // LYSUKA-KOT-9135
  '2025-10-10': 'TFlTVUtBLUtPVC0xMA==',     // LYSUKA-KOT-10

  // ðŸ”¹ ÐÐ¾Ð²Ñ‹Ðµ ÐºÐ»ÑŽÑ‡Ð¸ (Ñ 24.10.2025 Ð¿Ð¾ 23.11.2025)
  '2025-10-24': 'TFlTVUtBLUtPVC0xNzk=',   // LYSUKA-KOT-179
  '2025-10-25': 'TFlTVUtBLUtPVC00NzU=',   // LYSUKA-KOT-475
  '2025-10-26': 'TFlTVUtBLUtPVC01MTk=',   // LYSUKA-KOT-519
  '2025-10-27': 'TFlTVUtBLUtPVC05Mzg=',   // LYSUKA-KOT-938
  '2025-10-28': 'TFlTVUtBLUtPVC04NDM=',   // LYSUKA-KOT-843
  '2025-10-29': 'TFlTVUtBLUtPVC0xMzA5',   // LYSUKA-KOT-1309
  '2025-10-30': 'TFlTVUtBLUtPVC01Mzc=',   // LYSUKA-KOT-537
  '2025-10-31': 'TFlTVUtBLUtPVC00ODEw',   // LYSUKA-KOT-4810
  '2025-11-01': 'TFlTVUtBLUtPVC03MTA=',   // LYSUKA-KOT-710
  '2025-11-02': 'TFlTVUtBLUtPVC0zOTU=',   // LYSUKA-KOT-395
  '2025-11-03': 'TFlTVUtBLUtPVC03MDQ4',   // LYSUKA-KOT-7048
  '2025-11-04': 'TFlTVUtBLUtPVC05ODU=',   // LYSUKA-KOT-985
  '2025-11-05': 'TFlTVUtBLUtPVC0xODM5',   // LYSUKA-KOT-1839
  '2025-11-06': 'TFlTVUtBLUtPVC01Mzkx',   // LYSUKA-KOT-5391
  '2025-11-07': 'TFlTVUtBLUtPVC05MTA3',   // LYSUKA-KOT-9107
  '2025-11-08': 'TFlTVUtBLUtPVC04NTQ=',   // LYSUKA-KOT-854
  '2025-11-09': 'TFlTVUtBLUtPVC0zOTEw',   // LYSUKA-KOT-3910
  '2025-11-10': 'TFlTVUtBLUtPVC01NDA=',   // LYSUKA-KOT-540
  '2025-11-11': 'TFlTVUtBLUtPVC05ODM=',   // LYSUKA-KOT-983
  '2025-11-12': 'TFlTVUtBLUtPVC0xODc=',   // LYSUKA-KOT-187
  '2025-11-13': 'TFlTVUtBLUtPVC0zNTc=',   // LYSUKA-KOT-357
  '2025-11-14': 'TFlTVUtBLUtPVC03NDE=',   // LYSUKA-KOT-741
  '2025-11-15': 'TFlTVUtBLUtPVC0xOTM4',   // LYSUKA-KOT-1938
  '2025-11-16': 'TFlTVUtBLUtPVC01ODA=',   // LYSUKA-KOT-580
  '2025-11-17': 'TFlTVUtBLUtPVC03MTk=',   // LYSUKA-KOT-719
  '2025-11-18': 'TFlTVUtBLUtPVC04NDUz',   // LYSUKA-KOT-8453
  '2025-11-19': 'TFlTVUtBLUtPVC00MDc=',   // LYSUKA-KOT-407
  '2025-11-20': 'TFlTVUtBLUtPVC05MzE=',   // LYSUKA-KOT-931
  '2025-11-21': 'TFlTVUtBLUtPVC0xODA=',   // LYSUKA-KOT-180
  '2025-11-22': 'TFlTVUtBLUtPVC03NTk=',   // LYSUKA-KOT-759
  '2025-11-23': 'TFlTVUtBLUtPVC04Nzc=',   // LYSUKA-KOT-877
};

      keys = {};
      for (var date in encoded_keys) {
        keys[date] = atob(encoded_keys[date]);
      }
      localStorage.setItem('clickerKeys', JSON.stringify(keys));
    }
    document.getElementById('keyContainer').style.display = 'block';
    document.getElementById('authContainer').style.display = 'none';
    document.getElementById('loadingScreen').display = 'none';
    document.getElementById('gameScreen').style.display = 'none';
    document.addEventListener('keydown', function(event) {
      if (event.key === 'f' || event.key === 'F') {
        toggleConsole();
      }
    });
    document.addEventListener('keydown', function(event) {
      if (event.key === 'Escape' && document.getElementById('gameScreen').style.display !== 'none' && !isPaused) {
        pauseGame();
      } else if (event.key === 'Escape' && isPaused) {
        resumeGame();
      }
    });
    // Apply saved UI scale
    var savedScale = localStorage.getItem('uiScale') || '1';
    document.body.style.transform = `scale(${savedScale})`;
    document.body.style.transformOrigin = '0 0';
    document.body.style.width = `${100 / parseFloat(savedScale)}%`;
    document.body.style.height = `${100 / parseFloat(savedScale)}%`;

    // Apply language
    applyStaticTexts();
    updateQuestDescriptions();
  }

  function applyStaticTexts() {
    var t = translations[currentLanguage];
    document.title = t.title;
    document.getElementById('enterKeyTitle').innerText = t.enterKeyTitle;
    document.getElementById('inputText').placeholder = t.enterKeyPlaceholder;
    document.getElementById('submitKeyButton').innerText = t.submitKeyButton;
    document.getElementById('exitKeyButton').innerText = t.exitKeyButton;
    document.getElementById('demoModeButton').innerText = t.demoModeButton;
    document.getElementById('loginTitle').innerText = t.loginTitle;
    document.getElementById('loginUsername').placeholder = t.usernamePlaceholder;
    document.getElementById('loginPassword').placeholder = t.passwordPlaceholder;
    document.getElementById('loginButton').innerText = t.loginButton;
    document.getElementById('noAccountText').innerText = t.noAccountText;
    document.getElementById('registerLink').innerText = t.registerLink;
    document.getElementById('registerTitle').innerText = t.registerTitle;
    document.getElementById('regUsername').placeholder = t.usernamePlaceholder;
    document.getElementById('regPassword').placeholder = t.passwordPlaceholder;
    document.getElementById('registerButton').innerText = t.registerButton;
    document.getElementById('backButton').innerText = t.backButton;
    document.getElementById('shopButton').innerText = t.shopButton;
    document.getElementById('inventoryButton').innerText = t.inventoryButton;
    document.getElementById('questsButton').innerText = t.questsButton;
    document.getElementById('clickButton').innerText = t.clickButton;
    document.getElementById('achievementsButton').innerText = t.achievementsButton;
    document.getElementById('promoButton').innerText = t.promoButton;
    document.getElementById('exitButton').innerText = t.exitButton;
    document.getElementById('pauseTitle').innerText = t.pauseTitle;
    document.getElementById('resumeButton').innerText = t.resumeButton;
    document.getElementById('settingsButton').innerText = t.settingsButton;
    document.getElementById('logoutButton').innerText = t.logoutButton;
  }

  function setLanguage(lang) {
    if (lang !== currentLanguage) {
      currentLanguage = lang;
      localStorage.setItem('language', lang);
      updateAllUI();
    }
  }

  function updateAllUI() {
    var t = translations[currentLanguage];
    applyStaticTexts();
    updateQuestDescriptions();

    if (document.getElementById('gameScreen').style.display !== 'none') {
      updateLevel();
      updateMoney();
      updateCounter();
      updateCurrentQuest();
    }

    // Update demo elements if in demo
    var demoLabel = document.getElementById('demoLabel');
    if (demoLabel) {
      demoLabel.innerText = t.demoLabel;
    }
    var demoTimer = document.getElementById('demoTimer');
    if (demoTimer) {
      if (isInfiniteDemo) {
        demoTimer.innerText = t.demoTimerInfinity;
      } else {
        updateDemoTimer();
      }
    }

    // Re-render open menus
    if (document.getElementById('shopMenu').style.display === 'block') {
      renderShop();
    }
    if (document.getElementById('inventoryMenu').style.display === 'block') {
      renderInventory();
    }
    if (document.getElementById('adminMenu').style.display === 'block') {
      renderAdminPanel();
    }
    if (document.getElementById('issueClicksMenu').style.display === 'block') {
      showIssueClicks();
    }
    if (document.getElementById('issueCookieMenu').style.display === 'block') {
      showIssueCookie();
    }
    if (document.getElementById('issueAchievementMenu').style.display === 'block') {
      showIssueAchievement();
    }
    if (document.getElementById('blockedMenu').style.display === 'block') {
      renderBlocked();
    }
    if (document.getElementById('achievementsMenu').style.display === 'block') {
      renderAchievements();
    }
    if (document.getElementById('promoMenu').style.display === 'block') {
      renderPromo();
    }
    if (document.getElementById('demoExpiredMenu').style.display === 'block') {
      renderDemoExpired();
    }
    if (document.getElementById('consoleMenu').style.display === 'block') {
      renderConsole();
    }
    if (document.getElementById('questsMenu').style.display === 'block') {
      renderQuests();
    }
    if (document.getElementById('settingsMenu').style.display === 'block') {
      renderSettings();
    }
  }

  function showMsg(id, msg, success) {
    var elem = document.getElementById(id);
    elem.innerText = msg;
    elem.style.color = success ? 'green' : 'red';
  }

  function showRegister() {
    document.getElementById('loginScreen').style.display = 'none';
    document.getElementById('registerScreen').style.display = 'block';
    document.getElementById('loginMsg').innerText = '';
  }

  function showLogin() {
    document.getElementById('registerScreen').style.display = 'none';
    document.getElementById('loginScreen').style.display = 'block';
    document.getElementById('registerMsg').innerText = '';
  }

  function enterDemoMode() {
    isDemo = true;
    demoUser = {
      count: "0",
      money: "0",
      internal_level: 0,
      has_small_cookie: 0,
      equipped_small_cookie: 0,
      has_medium_cookie: 0,
      equipped_medium_cookie: 0,
      has_large_cookie: 0,
      equipped_large_cookie: 0,
      is_blocked: 0,
      achieved_100: 0,
      achieved_500: 0,
      achieved_1000: 0,
      achieved_3000: 0,
      achieved_5000: 0,
      achieved_10000: 0,
      active_quest: null,
      completed_quests: []
    };
    currentUsername = 'Demo';
    count = 0;
    money = 0;
    internal_level = 0;
    document.getElementById('keyContainer').classList.add('fade-out');
    setTimeout(() => {
      document.getElementById('keyContainer').style.display = 'none';
      showGame();
    }, 500);
  }

  function dragElement(el) {
    var pos1 = 0,
      pos2 = 0,
      pos3 = 0,
      pos4 = 0;
    el.querySelector('h3').onpointerdown = function() {
      dragMouseDown();
    };

    function dragMouseDown(e) {
      e = e || window.event;
      e.preventDefault();
      pos3 = e.clientX;
      pos4 = e.clientY;

      document.onpointerup = closeDragElement;
      document.onpointermove = elementDrag;
    }

    function elementDrag(e) {
      e = e || window.event;
      e.preventDefault();
      pos1 = pos3 - e.clientX;
      pos2 = pos4 - e.clientY;
      pos3 = e.clientX;
      pos4 = e.clientY;

      el.style.top = el.offsetTop - pos2 + 'px';
      el.style.left = el.offsetLeft - pos1 + 'px';
    }

    function closeDragElement() {
      document.onpointerup = null;
      document.onpointermove = null;
    }
  }

  function trim(str) {
    return str.replace(/^\s+|\s+$/g, '');
  }

  function checkKey() {
    var t = translations[currentLanguage];
    var currentDate = new Date().toISOString().split('T')[0];
    var enteredKey = trim(document.getElementById('inputText').value);
    var expectedKey = keys[currentDate];
    if (!expectedKey) {
      alert(t.keyNoDate);
      return;
    }
    if (enteredKey === expectedKey) {
      alert(t.keyCorrect);
      document.getElementById('keyContainer').classList.add('fade-out');
      setTimeout(() => {
        document.getElementById('keyContainer').style.display = 'none';
        document.getElementById('authContainer').style.display = 'block';
        setTimeout(() => {
          document.getElementById('authContainer').classList.add('fade-in');
        }, 10);
      }, 500);
    } else {
      alert(t.keyIncorrect);
    }
  }

  var quests = [
    { id: 1, clicksRequired: 50, timeLimit: 60, reward: 100, description: '' },
    { id: 2, clicksRequired: 100, timeLimit: 120, reward: 200, description: '' },
    { id: 3, clicksRequired: 200, timeLimit: 180, reward: 300, description: '' }
  ];

  var questStartTime = 0;
  var questClicks = 0;
  var questTimerInterval = null;

  function updateQuestDescriptions() {
    var t = translations[currentLanguage];
    quests.forEach(function(quest) {
      quest.description = t.questDescTemplate.replace('{required}', quest.clicksRequired).replace('{time}', quest.timeLimit);
    });
  }

  function formatInternalLevel(level) {
    return (level / 100).toFixed(2);
  }

  function showLoading() {
    var t = translations[currentLanguage];
    document.getElementById('authContainer').classList.remove('fade-in');
    setTimeout(() => {
      document.getElementById('authContainer').style.display = 'none';
      document.getElementById('loadingScreen').style.display = 'block';
      document.getElementById('loadingScreen').classList.add('visible');
    }, 500);
    var dots = 0;
    var loadingInterval = setInterval(function() {
      dots = (dots + 1) % 4; // Cycle from 0 to 3
      var text = t.loadingText;
      for (var i = 0; i < dots; i++) {
        text += '.';
      }
      document.getElementById('loadingText').innerText = text;
    }, 500); // Change every 0.5 seconds

    setTimeout(function() {
      clearInterval(loadingInterval); // Stop animation
      showGame();
    }, 5000);
  }

  function showBlocked() {
    renderBlocked();
    document.getElementById('authContainer').style.display = 'none';
    document.getElementById('blockedMenu').style.display = 'block';
    setTimeout(() => { document.getElementById('blockedMenu').classList.add('open'); }, 10);
    dragElement(document.getElementById('blockedMenu'));
  }

  function renderBlocked() {
    var t = translations[currentLanguage];
    var content = '<h3>' + t.blockedTitle + '</h3>';
    content += '<p>' + t.blockedText + '</p>';
    content += '<button onclick="doLogout()">' + t.logoutButton + '</button>';
    document.getElementById('blockedMenu').innerHTML = content;
  }

  function showGame() {
    var t = translations[currentLanguage];
    document.getElementById('loadingScreen').style.display = 'none';
    document.getElementById('gameScreen').style.display = 'block';
    setTimeout(() => { document.getElementById('gameScreen').classList.add('visible'); }, 10);
    var user = getCurrentUser();
    if (user) {
      count = parseFloat(user.count) || 0;
      money = parseFloat(user.money) || 0;
      internal_level = user.level || 0;
      updateCounter();
      updateMoney();
      updateLevel();
      updateCurrentQuest();
      if (user.active_quest !== null) {
        startQuestTimer();
        startQuestUpdateInterval();
      }
    } else {
      alert(t.userNotFoundAlert);
    }

    // Remove admin button if exists
    var existingAdminButton = document.getElementById('adminButton');
    if (existingAdminButton) {
      existingAdminButton.parentNode.removeChild(existingAdminButton);
    }

    // Add admin button only for Admin
    if (currentUsername === 'Admin') {
      var adminButton = document.createElement('button');
      adminButton.id = 'adminButton';
      adminButton.innerText = t.adminPanelTitle;
      adminButton.onclick = showAdminPanel;
      adminButton.style.position = 'absolute';
      adminButton.style.top = '0px';
      adminButton.style.right = '10px';
      adminButton.style.fontSize = '16px';
      adminButton.style.padding = '8px 16px';
      adminButton.style.backgroundColor = '#FF00FF'; // Magenta for admin
      document.getElementById('gameScreen').appendChild(adminButton);
    }

    // Remove demo elements if exist
    var existingDemoLabel = document.getElementById('demoLabel');
    if (existingDemoLabel) {
      existingDemoLabel.parentNode.removeChild(existingDemoLabel);
    }
    var existingDemoTimer = document.getElementById('demoTimer');
    if (existingDemoTimer) {
      existingDemoTimer.parentNode.removeChild(existingDemoTimer);
    }

    // Reset positions to default every time
    document.getElementById('shopButton').style.top = '0px';
    document.getElementById('inventoryButton').style.top = '40px';
    document.getElementById('questsButton').style.top = '80px';

    // Reset promo button to default
    document.getElementById('promoButton').disabled = false;
    document.getElementById('promoButton').style.backgroundColor = '#2196F3';
    document.getElementById('promoButton').onclick = showPromo;

    if (isDemo) {
      var demoLabel = document.createElement('div');
      demoLabel.id = 'demoLabel';
      demoLabel.innerText = t.demoLabel;
      demoLabel.style.position = 'absolute';
      demoLabel.style.top = '10px';
      demoLabel.style.left = '10px';
      demoLabel.style.color = 'blue';
      demoLabel.style.fontSize = '18px';
      demoLabel.style.fontWeight = 'bold';
      document.getElementById('gameScreen').appendChild(demoLabel);

      var demoTimer = document.createElement('div');
      demoTimer.id = 'demoTimer';
      demoTimer.style.position = 'absolute';
      demoTimer.style.top = '40px';
      demoTimer.style.left = '10px';
      demoTimer.style.color = 'red';
      demoTimer.style.fontSize = '16px';
      demoTimer.style.fontWeight = 'bold';
      document.getElementById('gameScreen').appendChild(demoTimer);
      updateDemoTimer();
      if (!isInfiniteDemo) {
        demoTimerInterval = setInterval(updateDemoTimer, 1000);
      } else {
        document.getElementById('demoTimer').innerText = t.demoTimerInfinity;
      }

      // Shift buttons down
      document.getElementById('shopButton').style.top = '60px';
      document.getElementById('inventoryButton').style.top = '100px';
      document.getElementById('questsButton').style.top = '140px';

      // Disable promo in demo
      document.getElementById('promoButton').disabled = true;
      document.getElementById('promoButton').style.backgroundColor = 'gray';
      document.getElementById('promoButton').onclick = function() { alert(t.promoDisabledInDemo); };
    }
  }

  function updateDemoTimer() {
    var t = translations[currentLanguage];
    if (demoTimeLeft <= 0) {
      clearInterval(demoTimerInterval);
      showDemoExpired();
      return;
    }
    var minutes = Math.floor(demoTimeLeft / 60);
    var seconds = demoTimeLeft % 60;
    document.getElementById('demoTimer').innerText = t.demoTimer + minutes + ':' + (seconds < 10 ? '0' : '') + seconds;
    demoTimeLeft--;
  }

  function showDemoExpired() {
    renderDemoExpired();
    document.getElementById('demoExpiredMenu').style.display = 'block';
    setTimeout(() => { document.getElementById('demoExpiredMenu').classList.add('open'); }, 10);
    dragElement(document.getElementById('demoExpiredMenu'));
    // Hide game screen
    document.getElementById('gameScreen').classList.remove('visible');
    setTimeout(() => { document.getElementById('gameScreen').style.display = 'none'; }, 500);
    demoJustExpired = true;
  }

  function renderDemoExpired() {
    var t = translations[currentLanguage];
    var content = '<h3>' + t.demoExpiredTitle + '</h3>';
    content += '<p>' + t.demoExpiredText + '</p>';
    content += '<button onclick="returnToKey()">' + t.ok + '</button>';
    document.getElementById('demoExpiredMenu').innerHTML = content;
  }

  function returnToKey() {
    document.getElementById('demoExpiredMenu').classList.remove('open');
    setTimeout(() => { document.getElementById('demoExpiredMenu').style.display = 'none'; }, 500);
    document.getElementById('gameScreen').classList.remove('visible');
    setTimeout(() => { document.getElementById('gameScreen').style.display = 'none'; }, 500);
    document.getElementById('keyContainer').style.display = 'block';
    document.getElementById('keyContainer').style.opacity = '1';
    document.getElementById('keyContainer').style.transform = 'translateY(0)';
    document.getElementById('keyContainer').classList.remove('fade-out');
    document.getElementById('authContainer').style.display = 'none';
    document.getElementById('authContainer').classList.remove('fade-in');
    isDemo = false;
    demoUser = null;
    currentUsername = '';
    count = 0;
    money = 0;
    internal_level = 0;
    if (demoTimerInterval) clearInterval(demoTimerInterval);
    isInfiniteDemo = false;
  }

  function updateCounter() {
    var t = translations[currentLanguage];
    document.getElementById('counter').innerText = t.counter + count;
  }

  function updateMoney() {
    var t = translations[currentLanguage];
    document.getElementById('money').innerText = t.money + money;
  }

  function updateLevel() {
    var t = translations[currentLanguage];
    document.getElementById('level').innerText = t.level + formatInternalLevel(internal_level);
  }

  function showShop() {
    renderShop();
    document.getElementById('shopMenu').style.display = 'block';
    setTimeout(() => { document.getElementById('shopMenu').classList.add('open'); }, 10);
    dragElement(document.getElementById('shopMenu'));
  }

  function renderShop() {
    var t = translations[currentLanguage];
    var user = getCurrentUser();
    var content = '<h3>' + t.shopTitle + '</h3>';
    content += '<p>' + t.smallCookie + ' - 300 clicks</p>';
    if (!user.has_small_cookie) {
      content += '<button onclick="buySmallCookie()">' + t.buy + '</button>';
    } else {
      content += '<p>' + t.bought + '</p>';
    }
    content += '<p>' + t.mediumCookie + ' - 700 clicks</p>';
    if (!user.has_medium_cookie) {
      content += '<button onclick="buyMediumCookie()">' + t.buy + '</button>';
    } else {
      content += '<p>' + t.bought + '</p>';
    }
    content += '<p>' + t.largeCookie + ' - 1000 clicks</p>';
    if (!user.has_large_cookie) {
      content += '<button onclick="buyLargeCookie()">' + t.buy + '</button>';
    } else {
      content += '<p>' + t.bought + '</p>';
    }
    content += '<br><button onclick="closeShop()">' + t.close + '</button>';
    document.getElementById('shopMenu').innerHTML = content;
  }

  function closeShop() {
    document.getElementById('shopMenu').classList.remove('open');
    setTimeout(() => { document.getElementById('shopMenu').style.display = 'none'; }, 500); // Longer transition
  }

  async function buySmallCookie() {
    const t = translations[currentLanguage];
    if (count >= 300) {
      count -= 300;
      if (isDemo) {
        demoUser.count = count;
        demoUser.has_small_cookie = 1;
      } else {
        userData.count = count;
        userData.has_small_cookie = 1;
        await update(ref(db, 'users/' + currentUid), { count: count, has_small_cookie: 1 });
      }
      updateCounter();
      alert(t.boughtSuccess);
      renderShop();
    } else {
      alert(t.notEnoughClicks);
    }
  }

  async function buyMediumCookie() {
    const t = translations[currentLanguage];
    if (count >= 700) {
      count -= 700;
      if (isDemo) {
        demoUser.count = count;
        demoUser.has_medium_cookie = 1;
      } else {
        userData.count = count;
        userData.has_medium_cookie = 1;
        await update(ref(db, 'users/' + currentUid), { count: count, has_medium_cookie: 1 });
      }
      updateCounter();
      alert(t.boughtSuccess);
      renderShop();
    } else {
      alert(t.notEnoughClicks);
    }
  }

  async function buyLargeCookie() {
    const t = translations[currentLanguage];
    if (count >= 1000) {
      count -= 1000;
      if (isDemo) {
        demoUser.count = count;
        demoUser.has_large_cookie = 1;
      } else {
        userData.count = count;
        userData.has_large_cookie = 1;
        await update(ref(db, 'users/' + currentUid), { count: count, has_large_cookie: 1 });
      }
      updateCounter();
      alert(t.boughtSuccess);
      renderShop();
    } else {
      alert(t.notEnoughClicks);
    }
  }

  function showInventory() {
    renderInventory();
    document.getElementById('inventoryMenu').style.display = 'block';
    setTimeout(() => { document.getElementById('inventoryMenu').classList.add('open'); }, 10);
    dragElement(document.getElementById('inventoryMenu'));
  }

  function renderInventory() {
    var t = translations[currentLanguage];
    var user = getCurrentUser();
    var content = '<h3>' + t.inventoryTitle + '</h3>';
    var hasItems = false;
    if (user.has_small_cookie) {
      hasItems = true;
      content += '<p>' + t.smallCookie;
      if (user.equipped_small_cookie) {
        content += t.equipped + ' <button onclick="unequipSmallCookie()">' + t.unequip + '</button>';
      } else {
        content += ' <button onclick="equipSmallCookie()">' + t.equip + '</button>';
      }
      content += '</p>';
    }
    if (user.has_medium_cookie) {
      hasItems = true;
      content += '<p>' + t.mediumCookie;
      if (user.equipped_medium_cookie) {
        content += t.equipped + ' <button onclick="unequipMediumCookie()">' + t.unequip + '</button>';
      } else {
        content += ' <button onclick="equipMediumCookie()">' + t.equip + '</button>';
      }
      content += '</p>';
    }
    if (user.has_large_cookie) {
      hasItems = true;
      content += '<p>' + t.largeCookie;
      if (user.equipped_large_cookie) {
        content += t.equipped + ' <button onclick="unequipLargeCookie()">' + t.unequip + '</button>';
      } else {
        content += ' <button onclick="equipLargeCookie()">' + t.equip + '</button>';
      }
      content += '</p>';
    }
    if (!hasItems) {
      content += '<p>' + t.inventoryEmpty + '</p>';
    }
    content += '<button onclick="closeInventory()">' + t.close + '</button>';
    document.getElementById('inventoryMenu').innerHTML = content;
  }

  function closeInventory() {
    document.getElementById('inventoryMenu').classList.remove('open');
    setTimeout(() => { document.getElementById('inventoryMenu').style.display = 'none'; }, 500);
  }

  async function equipSmallCookie() {
    if (isDemo) {
      demoUser.equipped_small_cookie = 1;
    } else {
      userData.equipped_small_cookie = 1;
      await update(ref(db, 'users/' + currentUid), { equipped_small_cookie: 1 });
    }
    renderInventory();
  }

  async function unequipSmallCookie() {
    if (isDemo) {
      demoUser.equipped_small_cookie = 0;
    } else {
      userData.equipped_small_cookie = 0;
      await update(ref(db, 'users/' + currentUid), { equipped_small_cookie: 0 });
    }
    renderInventory();
  }

  async function equipMediumCookie() {
    if (isDemo) {
      demoUser.equipped_medium_cookie = 1;
    } else {
      userData.equipped_medium_cookie = 1;
      await update(ref(db, 'users/' + currentUid), { equipped_medium_cookie: 1 });
    }
    renderInventory();
  }

  async function unequipMediumCookie() {
    if (isDemo) {
      demoUser.equipped_medium_cookie = 0;
    } else {
      userData.equipped_medium_cookie = 0;
      await update(ref(db, 'users/' + currentUid), { equipped_medium_cookie: 0 });
    }
    renderInventory();
  }

  async function equipLargeCookie() {
    if (isDemo) {
      demoUser.equipped_large_cookie = 1;
    } else {
      userData.equipped_large_cookie = 1;
      await update(ref(db, 'users/' + currentUid), { equipped_large_cookie: 1 });
    }
    renderInventory();
  }

  async function unequipLargeCookie() {
    if (isDemo) {
      demoUser.equipped_large_cookie = 0;
    } else {
      userData.equipped_large_cookie = 0;
      await update(ref(db, 'users/' + currentUid), { equipped_large_cookie: 0 });
    }
    renderInventory();
  }

  function showAdminPanel() {
    renderAdminPanel();
    document.getElementById('adminMenu').style.display = 'block';
    setTimeout(() => { document.getElementById('adminMenu').classList.add('open'); }, 10);
    dragElement(document.getElementById('adminMenu'));
  }

  function renderAdminPanel() {
    var t = translations[currentLanguage];
    var content = '<h3>' + t.adminPanelTitle + '</h3>';
    content += '<input id="targetUsername" type="text" placeholder="' + t.targetUsernamePlaceholder + '" />';
    content += '<br><button onclick="showIssueClicks()">' + t.issueClicks + '</button><br>';
    content += '<button onclick="showIssueCookie()">' + t.issueCookie + '</button><br>';
    content += '<button onclick="showIssueAchievement()">' + t.issueAchievement + '</button><br>';
    content += '<button onclick="blockAccount()">' + t.block + '</button>';
    content += '<button onclick="unblockAccount()" style="margin-left:10px;">' + t.unblock + '</button><br>';
    content += '<button onclick="resetCount()">' + t.resetClicks + '</button><br>';
    content += '<button onclick="closeAdminPanel()">' + t.close + '</button>';
    document.getElementById('adminMenu').innerHTML = content;
  }

  function closeAdminPanel() {
    document.getElementById('adminMenu').classList.remove('open');
    setTimeout(() => { document.getElementById('adminMenu').style.display = 'none'; }, 500);
  }

  function showIssueClicks() {
    var t = translations[currentLanguage];
    var content = '<h3>' + t.issueClicksTitle + '</h3>';
    content += '<input id="clickAmount" type="number" placeholder="' + t.clickAmountPlaceholder + '" />';
    content += '<br><button onclick="confirmIssueClicks()">' + t.issue + '</button>';
    content += '<button onclick="closeIssueClicks()">' + t.close + '</button>';
    document.getElementById('issueClicksMenu').innerHTML = content;
    document.getElementById('issueClicksMenu').style.display = 'block';
    setTimeout(() => { document.getElementById('issueClicksMenu').classList.add('open'); }, 10);
    dragElement(document.getElementById('issueClicksMenu'));
  }

  function closeIssueClicks() {
    document.getElementById('issueClicksMenu').classList.remove('open');
    setTimeout(() => { document.getElementById('issueClicksMenu').style.display = 'none'; }, 500);
  }

  function showIssueCookie() {
    var t = translations[currentLanguage];
    var content = '<h3>' + t.issueCookieTitle + '</h3>';
    content += '<button onclick="confirmIssueCookie(1)">' + t.small + '</button>';
    content += '<button onclick="confirmIssueCookie(2)">' + t.medium + '</button>';
    content += '<button onclick="confirmIssueCookie(3)">' + t.large + '</button>';
    content += '<br><button onclick="closeIssueCookie()">' + t.close + '</button>';
    document.getElementById('issueCookieMenu').innerHTML = content;
    document.getElementById('issueCookieMenu').style.display = 'block';
    setTimeout(() => { document.getElementById('issueCookieMenu').classList.add('open'); }, 10);
    dragElement(document.getElementById('issueCookieMenu'));
  }

  function closeIssueCookie() {
    document.getElementById('issueCookieMenu').classList.remove('open');
    setTimeout(() => { document.getElementById('issueCookieMenu').style.display = 'none'; }, 500);
  }

  function showIssueAchievement() {
    var t = translations[currentLanguage];
    var content = '<h3>' + t.issueAchievementTitle + '</h3>';
    content += '<button onclick="confirmIssueAchievement(1)">' + t.achievement100 + '</button>';
    content += '<button onclick="confirmIssueAchievement(2)">' + t.achievement500 + '</button>';
    content += '<button onclick="confirmIssueAchievement(3)">' + t.achievement1000 + '</button>';
    content += '<button onclick="confirmIssueAchievement(4)">' + t.achievement3000 + '</button>';
    content += '<button onclick="confirmIssueAchievement(5)">' + t.achievement5000 + '</button>';
    content += '<button onclick="confirmIssueAchievement(6)">' + t.achievement10000 + '</button>';
    content += '<br><button onclick="closeIssueAchievement()">' + t.close + '</button>';
    document.getElementById('issueAchievementMenu').innerHTML = content;
    document.getElementById('issueAchievementMenu').style.display = 'block';
    setTimeout(() => { document.getElementById('issueAchievementMenu').classList.add('open'); }, 10);
    dragElement(document.getElementById('issueAchievementMenu'));
  }

  function closeIssueAchievement() {
    document.getElementById('issueAchievementMenu').classList.remove('open');
    setTimeout(() => { document.getElementById('issueAchievementMenu').style.display = 'none'; }, 500);
  }

  async function getTargetUser() {
    var t = translations[currentLanguage];
    var target = trim(document.getElementById('targetUsername').value);
    if (target === '') {
      alert(t.enterUsername);
      return null;
    }
    if (isDemo && target === 'Demo') {
      return 'Demo'; // Special handling for demo
    }
    const user = await getUserByUsername(target);
    if (!user) {
      alert(t.userNotFound);
      return null;
    }
    return target;
  }

  async function getUser(target) {
    if (isDemo && target === 'Demo') {
      return demoUser;
    }
    return await getUserByUsername(target);
  }

  async function confirmIssueClicks() {
    var t = translations[currentLanguage];
    var target = await getTargetUser();
    if (target) {
      var amountStr = document.getElementById('clickAmount').value;
      var amount = parseInt(amountStr);
      if (isNaN(amount) || amount <= 0) {
        alert(t.invalidAmount);
        return;
      }
      var user = await getUser(target);
      var currentCount = parseFloat(user.count) || 0;
      var newCount = currentCount + amount;
      var uid = await getUidByUsername(target);
      await update(ref(db, 'users/' + uid), { count: newCount });
      checkAchievements(target);
      alert(t.issuedClicks.replace('{amount}', amount).replace('{target}', target));
      if (target === currentUsername) {
        count = newCount;
        updateCounter();
      }
      closeIssueClicks();
    }
  }

  async function confirmIssueCookie(choice) {
    var t = translations[currentLanguage];
    var target = await getTargetUser();
    if (target) {
      var uid = await getUidByUsername(target);
      var updates = {};
      if (choice === 1) {
        updates.has_small_cookie = 1;
        alert(t.issuedCookieSmall.replace('{target}', target));
      } else if (choice === 2) {
        updates.has_medium_cookie = 1;
        alert(t.issuedCookieMedium.replace('{target}', target));
      } else if (choice === 3) {
        updates.has_large_cookie = 1;
        alert(t.issuedCookieLarge.replace('{target}', target));
      }
      await update(ref(db, 'users/' + uid), updates);
      if (target === currentUsername) {
        Object.assign(userData, updates);
      }
      closeIssueCookie();
    }
  }

  async function confirmIssueAchievement(choice) {
    var t = translations[currentLanguage];
    var target = await getTargetUser();
    if (target) {
      var uid = await getUidByUsername(target);
      var updates = {};
      var name;
      if (choice === 1) {
        updates.achieved_100 = 1;
        name = t.achievement100;
      } else if (choice === 2) {
        updates.achieved_500 = 1;
        name = t.achievement500;
      } else if (choice === 3) {
        updates.achieved_1000 = 1;
        name = t.achievement1000;
      } else if (choice === 4) {
        updates.achieved_3000 = 1;
        name = t.achievement3000;
      } else if (choice === 5) {
        updates.achieved_5000 = 1;
        name = t.achievement5000;
      } else if (choice === 6) {
        updates.achieved_10000 = 1;
        name = t.achievement10000;
      }
      await update(ref(db, 'users/' + uid), updates);
      alert(t.issuedAchievement.replace('{name}', name).replace('{target}', target));
      if (target === currentUsername) {
        Object.assign(userData, updates);
      }
      closeIssueAchievement();
    }
  }

  async function blockAccount() {
    var t = translations[currentLanguage];
    var target = await getTargetUser();
    if (target) {
      var uid = await getUidByUsername(target);
      await update(ref(db, 'users/' + uid), { is_blocked: 1 });
      alert(t.blocked.replace('{target}', target));
    }
  }

  async function unblockAccount() {
    var t = translations[currentLanguage];
    var target = await getTargetUser();
    if (target) {
      var uid = await getUidByUsername(target);
      await update(ref(db, 'users/' + uid), { is_blocked: 0 });
      alert(t.unblocked.replace('{target}', target));
    }
  }

  async function resetCount() {
    var t = translations[currentLanguage];
    var target = await getTargetUser();
    if (target) {
      var uid = await getUidByUsername(target);
      await update(ref(db, 'users/' + uid), {
        count: 0,
        achieved_100: 0,
        achieved_500: 0,
        achieved_1000: 0,
        achieved_3000: 0,
        achieved_5000: 0,
        achieved_10000: 0
      });
      alert(t.clicksReset.replace('{target}', target));
      if (target === currentUsername) {
        count = 0;
        userData.count = 0;
        userData.achieved_100 = 0;
        userData.achieved_500 = 0;
        userData.achieved_1000 = 0;
        userData.achieved_3000 = 0;
        userData.achieved_5000 = 0;
        userData.achieved_10000 = 0;
        updateCounter();
      }
    }
  }

  async function doLogout() {
    var t = translations[currentLanguage];
    if (currentUsername && !isDemo) {
      await update(ref(db, 'users/' + currentUid), {
        count: count,
        money: money,
        level: internal_level
      });
    }
    currentUsername = '';
    count = 0;
    money = 0;
    internal_level = 0;
    userData = null;
    currentUid = null;
    if (questTimerInterval) clearInterval(questTimerInterval);
    if (questUpdateInterval) clearInterval(questUpdateInterval);
    if (demoTimerInterval) clearInterval(demoTimerInterval);
    document.getElementById('gameScreen').classList.remove('visible');
    setTimeout(() => { document.getElementById('gameScreen').style.display = 'none'; }, 500);
    document.getElementById('blockedMenu').classList.remove('open');
    setTimeout(() => { document.getElementById('blockedMenu').style.display = 'none'; }, 500);
    document.getElementById('pauseOverlay').style.display = 'none';
    isPaused = false;
    if (isDemo) {
      returnToKey();
    } else {
      document.getElementById('keyContainer').style.display = 'none';
      document.getElementById('keyContainer').style.opacity = '1';
      document.getElementById('keyContainer').style.transform = 'translateY(0)';
      document.getElementById('keyContainer').classList.remove('fade-out');
      document.getElementById('authContainer').style.display = 'block';
      showLogin();
      setTimeout(() => {
        document.getElementById('authContainer').classList.add('fade-in');
      }, 10);
    }
  }

  async function checkAchievements(target) {
    var t = translations[currentLanguage];
    var user;
    if (isDemo && target === 'Demo') {
      user = demoUser;
    } else {
      user = (target === currentUsername) ? userData : await getUser(target);
    }
    var userCount = parseFloat(user.count) || 0;
    var achievements = [
      { threshold: 100, field: 'achieved_100', name: t.achievement100, amount: 100 },
      { threshold: 500, field: 'achieved_500', name: t.achievement500, amount: 500 },
      { threshold: 1000, field: 'achieved_1000', name: t.achievement1000, amount: 1000 },
      { threshold: 3000, field: 'achieved_3000', name: t.achievement3000, amount: 3000 },
      { threshold: 5000, field: 'achieved_5000', name: t.achievement5000, amount: 5000 },
      { threshold: 10000, field: 'achieved_10000', name: t.achievement10000, amount: 10000 }
    ];
    var updates = {};
    achievements.forEach(ach => {
      if (userCount >= ach.threshold && !user[ach.field]) {
        updates[ach.field] = 1;
        if (target === currentUsername) alert(t.achievementUnlocked.replace('{name}', ach.name).replace('{amount}', ach.amount));
      }
    });
    if (Object.keys(updates).length > 0) {
      if (isDemo && target === 'Demo') {
        Object.assign(demoUser, updates);
      } else {
        var uid = (target === currentUsername) ? currentUid : await getUidByUsername(target);
        await update(ref(db, 'users/' + uid), updates);
        if (target === currentUsername) {
          Object.assign(userData, updates);
        }
      }
    }
  }

  function showAchievements() {
    renderAchievements();
    document.getElementById('achievementsMenu').style.display = 'block';
    setTimeout(() => { document.getElementById('achievementsMenu').classList.add('open'); }, 10);
    dragElement(document.getElementById('achievementsMenu'));
  }

  function renderAchievements() {
    var t = translations[currentLanguage];
    var user = getCurrentUser();
    var content = '<h3>' + t.achievementsTitle + '</h3>';
    content += '<p>' + t.achievement100Desc + (user.achieved_100 ? t.achieved : t.notAchieved) + '</p>';
    content += '<p>' + t.achievement500Desc + (user.achieved_500 ? t.achieved : t.notAchieved) + '</p>';
    content += '<p>' + t.achievement1000Desc + (user.achieved_1000 ? t.achieved : t.notAchieved) + '</p>';
    content += '<p>' + t.achievement3000Desc + (user.achieved_3000 ? t.achieved : t.notAchieved) + '</p>';
    content += '<p>' + t.achievement5000Desc + (user.achieved_5000 ? t.achieved : t.notAchieved) + '</p>';
    content += '<p>' + t.achievement10000Desc + (user.achieved_10000 ? t.achieved : t.notAchieved) + '</p>';
    content += '<button onclick="closeAchievements()">' + t.close + '</button>';
    document.getElementById('achievementsMenu').innerHTML = content;
  }

  function closeAchievements() {
    document.getElementById('achievementsMenu').classList.remove('open');
    setTimeout(() => { document.getElementById('achievementsMenu').style.display = 'none'; }, 500);
  }

  function showPromo() {
    var t = translations[currentLanguage];
    if (isDemo) {
      alert(t.promoDisabledInDemo);
      return;
    }
    renderPromo();
    document.getElementById('promoMenu').style.display = 'block';
    setTimeout(() => { document.getElementById('promoMenu').classList.add('open'); }, 10);
    dragElement(document.getElementById('promoMenu'));
  }

  function renderPromo() {
    var t = translations[currentLanguage];
    var content = '<h3>' + t.promoTitle + '</h3>';
    content += '<input id="promoCode" type="text" placeholder="' + t.promoPlaceholder + '" />';
    content += '<br><button onclick="redeemPromo()">' + t.redeem + '</button>';
    content += '<button onclick="closePromo()">' + t.close + '</button>';
    document.getElementById('promoMenu').innerHTML = content;
  }

  function closePromo() {
    document.getElementById('promoMenu').classList.remove('open');
    setTimeout(() => { document.getElementById('promoMenu').style.display = 'none'; }, 500);
  }

  async function redeemPromo() {
    var t = translations[currentLanguage];
    var code = trim(document.getElementById('promoCode').value).toUpperCase();
    var updates = {};
    if (code === 'LYSUKA') {
      updates.has_small_cookie = 1;
      alert(t.promoSmallCookie);
    } else if (code === 'KOT') {
      count += 100;
      updates.count = count;
      updateCounter();
      checkAchievements(currentUsername);
      alert(t.promo100Clicks);
    } else if (code === 'SUKA') {
      updates.has_large_cookie = 1;
      alert(t.promoLargeCookie);
    } else {
      alert(t.invalidPromo);
      return;
    }
    await update(ref(db, 'users/' + currentUid), updates);
    Object.assign(userData, updates);
    closePromo();
  }

  // Console
  function toggleConsole() {
    var consoleMenu = document.getElementById('consoleMenu');
    if (consoleMenu.style.display === 'block') {
      closeConsole();
    } else {
      renderConsole();
      consoleMenu.style.display = 'block';
      setTimeout(() => { consoleMenu.classList.add('open'); }, 10);
      dragElement(consoleMenu);
    }
  }

  function renderConsole() {
    var t = translations[currentLanguage];
    var content = '<h3>' + t.consoleTitle + '</h3>';
    content += '<input id="consoleInput" type="text" placeholder="' + t.consolePlaceholder + '" />';
    content += '<br><button onclick="executeConsoleCommand()">' + t.execute + '</button>';
    content += '<button onclick="closeConsole()">' + t.close + '</button>';
    document.getElementById('consoleMenu').innerHTML = content;
  }

  function closeConsole() {
    var consoleMenu = document.getElementById('consoleMenu');
    consoleMenu.classList.remove('open');
    setTimeout(() => { consoleMenu.style.display = 'none'; }, 500);
  }

  async function executeConsoleCommand() {
    var t = translations[currentLanguage];
    var command = trim(document.getElementById('consoleInput').value).toLowerCase();
    if (command === '') {
      alert(t.enterCommand);
      return;
    }
    var updates = {};
    if (command.startsWith('click:set(')) {
      var match = command.match(/click:set\((\d+)\)/);
      if (match) {
        var amount = parseInt(match[1]);
        if (!isNaN(amount) && amount >= 0) {
          count = amount;
          if (isDemo) {
            demoUser.count = count;
          } else {
            updates.count = count;
            await update(ref(db, 'users/' + currentUid), updates);
            userData.count = count;
          }
          checkAchievements(currentUsername);
          updateCounter();
          alert(t.setClicksSuccess.replace('{amount}', amount));
        } else {
          alert(t.invalidNumber);
        }
      } else {
        alert(t.invalidFormat.replace('{format}', 'click:set(Ñ‡Ð¸ÑÐ»Ð¾)'));
      }
    } else if (command === 'give:cookie.small') {
      if (isDemo) {
        demoUser.has_small_cookie = 1;
      } else {
        updates.has_small_cookie = 1;
        await update(ref(db, 'users/' + currentUid), updates);
        userData.has_small_cookie = 1;
      }
      alert(t.gaveSmallCookie);
    } else if (command === 'give:cookie.medium') {
      if (isDemo) {
        demoUser.has_medium_cookie = 1;
      } else {
        updates.has_medium_cookie = 1;
        await update(ref(db, 'users/' + currentUid), updates);
        userData.has_medium_cookie = 1;
      }
      alert(t.gaveMediumCookie);
    } else if (command === 'give:cookie.big') {
      if (isDemo) {
        demoUser.has_large_cookie = 1;
      } else {
        updates.has_large_cookie = 1;
        await update(ref(db, 'users/' + currentUid), updates);
        userData.has_large_cookie = 1;
      }
      alert(t.gaveLargeCookie);
    } else if (command === 'demomode:exit') {
      if (isDemo) {
        closeConsole();
        returnToKey();
        alert(t.exitDemo);
      } else {
        alert(t.notInDemo);
      }
    } else if (command === 'autopasskey') {
      if (document.getElementById('keyContainer').style.display === 'block') {
        document.getElementById('keyContainer').classList.add('fade-out');
        setTimeout(() => {
          document.getElementById('keyContainer').style.display = 'none';
          document.getElementById('authContainer').style.display = 'block';
          setTimeout(() => {
            document.getElementById('authContainer').classList.add('fade-in');
            showRegister();
          }, 10);
        }, 500);
        alert(t.autoPassKey);
      } else {
        alert(t.notInKeyMenu);
      }
    } else if (command.startsWith('demomode:edit_time:set(')) {
      var match = command.match(/demomode:edit_time:set\((.+)\)/);
      if (match) {
        var timeStr = match[1].toLowerCase();
        if (timeStr === 'infinity') {
          if (isDemo) {
            clearInterval(demoTimerInterval);
            isInfiniteDemo = true;
            document.getElementById('demoTimer').innerText = t.demoTimerInfinity;
            alert(t.demoTimeInfinity);
          } else {
            alert(t.notInDemo);
          }
        } else {
          var timeParts = timeStr.split(':');
          if (timeParts.length === 3) {
            var hours = parseInt(timeParts[0]);
            var minutes = parseInt(timeParts[1]);
            var seconds = parseInt(timeParts[2]);
            if (!isNaN(hours) && !isNaN(minutes) && !isNaN(seconds) && hours >= 0 && minutes >= 0 && seconds >= 0) {
              if (isDemo) {
                demoTimeLeft = hours * 3600 + minutes * 60 + seconds;
                if (isInfiniteDemo) {
                  isInfiniteDemo = false;
                  demoTimerInterval = setInterval(updateDemoTimer, 1000);
                }
                updateDemoTimer();
                alert(t.demoTimeSet.replace('{time}', timeStr));
              } else {
                alert(t.notInDemo);
              }
            } else {
              alert(t.invalidTimeFormat);
            }
          } else {
            alert(t.invalidFormat.replace('{format}', 'demomode:edit_time:set(00:00:00) or demomode:edit_time:set(infinity)'));
          }
        }
      } else {
        alert(t.invalidFormat.replace('{format}', 'demomode:edit_time:set(00:00:00) or demomode:edit_time:set(infinity)'));
      }
    } else {
      alert(t.invalidCommand.replace('{command}', command));
    }
    document.getElementById('consoleInput').value = '';
  }

  // Quests
  function showQuests() {
    renderQuests();
    document.getElementById('questsMenu').style.display = 'block';
    setTimeout(() => { document.getElementById('questsMenu').classList.add('open'); }, 10);
    dragElement(document.getElementById('questsMenu'));
  }

  function renderQuests() {
    var t = translations[currentLanguage];
    var user = getCurrentUser();
    var content = '<h3>' + t.questsTitle + '</h3>';
    quests.forEach(function(quest) {
      var isCompleted = user.completed_quests.includes(quest.id);
      var isActive = user.active_quest === quest.id;
      var status = isCompleted ? t.questCompleted : t.questNotCompleted;
      content += '<p>' + status + ' ' + quest.description + ' reward: ' + quest.reward + ' money</p>';
      if (!isCompleted) {
        if (isActive) {
          content += '<button onclick="cancelQuest(' + quest.id + ')">' + t.cancelQuest + '</button>';
        } else {
          content += '<button onclick="takeQuest(' + quest.id + ')">' + t.takeQuest + '</button>';
        }
      }
      content += '<br>';
    });
    content += '<button onclick="closeQuests()">' + t.close + '</button>';
    document.getElementById('questsMenu').innerHTML = content;
  }

  function closeQuests() {
    document.getElementById('questsMenu').classList.remove('open');
    setTimeout(() => { document.getElementById('questsMenu').style.display = 'none'; }, 500);
  }

  async function takeQuest(questId) {
    var t = translations[currentLanguage];
    var user = getCurrentUser();
    if (user.active_quest !== null) {
      alert(t.activeQuest);
      return;
    }
    user.active_quest = questId;
    if (isDemo) {
      demoUser.active_quest = questId;
    } else {
      await update(ref(db, 'users/' + currentUid), { active_quest: questId });
    }
    questStartTime = Date.now();
    questClicks = 0;
    startQuestTimer();
    startQuestUpdateInterval();
    updateCurrentQuest();
    closeQuests();
  }

  async function cancelQuest(questId) {
    var t = translations[currentLanguage];
    var user = getCurrentUser();
    if (user.active_quest === questId) {
      user.active_quest = null;
      if (isDemo) {
        demoUser.active_quest = null;
      } else {
        await update(ref(db, 'users/' + currentUid), { active_quest: null });
      }
      if (questTimerInterval) clearInterval(questTimerInterval);
      if (questUpdateInterval) clearInterval(questUpdateInterval);
      updateCurrentQuest();
      alert(t.questCancelled);
      renderQuests();
    }
  }

  function startQuestTimer() {
    if (questTimerInterval) clearInterval(questTimerInterval);
    questTimerInterval = setInterval(checkQuestCompletion, 1000);
  }

  function startQuestUpdateInterval() {
    if (questUpdateInterval) clearInterval(questUpdateInterval);
    questUpdateInterval = setInterval(updateCurrentQuest, 1000);
  }

  async function checkQuestCompletion() {
    var t = translations[currentLanguage];
    var user = getCurrentUser();
    if (user.active_quest === null) return;
    var quest = quests.find(q => q.id === user.active_quest);
    if (!quest) return;
    var elapsed = (Date.now() - questStartTime) / 1000;
    if (elapsed > quest.timeLimit) {
      alert(t.questTimeExpired);
      user.active_quest = null;
      if (isDemo) {
        demoUser.active_quest = null;
      } else {
        await update(ref(db, 'users/' + currentUid), { active_quest: null });
      }
      if (questTimerInterval) clearInterval(questTimerInterval);
      if (questUpdateInterval) clearInterval(questUpdateInterval);
      updateCurrentQuest();
      return;
    }
    if (questClicks >= quest.clicksRequired) {
      money += quest.reward;
      internal_level += 500;
      if (isDemo) {
        demoUser.money = money;
        demoUser.level = internal_level;
        demoUser.completed_quests.push(quest.id);
        demoUser.active_quest = null;
      } else {
        userData.money = money;
        userData.level = internal_level;
        userData.completed_quests.push(quest.id);
        userData.active_quest = null;
        await update(ref(db, 'users/' + currentUid), {
          money: money,
          level: internal_level,
          completed_quests: userData.completed_quests,
          active_quest: null
        });
      }
      if (questTimerInterval) clearInterval(questTimerInterval);
      if (questUpdateInterval) clearInterval(questUpdateInterval);
      updateMoney();
      updateLevel();
      updateCurrentQuest();
      alert(t.questCompletedSuccess.replace('{reward}', quest.reward));
    }
  }

  function updateCurrentQuest() {
    var t = translations[currentLanguage];
    var user = getCurrentUser();
    if (user.active_quest === null) {
      document.getElementById('currentQuest').innerText = t.currentQuestNone;
    } else {
      var quest = quests.find(q => q.id === user.active_quest);
      var remaining = Math.max(0, quest.timeLimit - Math.floor((Date.now() - questStartTime) / 1000));
      document.getElementById('currentQuest').innerText = t.currentQuest.replace('{clicks}', questClicks).replace('{required}', quest.clicksRequired).replace('{remaining}', remaining);
    }
  }

  // Pause
  function pauseGame() {
    if (isPaused) return;
    isPaused = true;
    pauseStartTime = Date.now();
    var user = getCurrentUser();
    wasQuestActive = (user.active_quest !== null);
    wasDemoTimerActive = (isDemo && !isInfiniteDemo && demoTimerInterval !== null);
    if (questTimerInterval) clearInterval(questTimerInterval);
    if (questUpdateInterval) clearInterval(questUpdateInterval);
    if (wasDemoTimerActive) clearInterval(demoTimerInterval);
    document.getElementById('pauseOverlay').style.display = 'flex';
  }

  function resumeGame() {
    if (!isPaused) return;
    isPaused = false;
    var pauseDuration = Date.now() - pauseStartTime;
    var user = getCurrentUser();
    if (wasQuestActive) {
      questStartTime += pauseDuration;
      startQuestTimer();
      startQuestUpdateInterval();
    }
    if (wasDemoTimerActive) {
      demoTimerInterval = setInterval(updateDemoTimer, 1000);
    }
    document.getElementById('pauseOverlay').style.display = 'none';
  }

  function showSettings() {
    renderSettings();
    document.getElementById('settingsMenu').style.display = 'block';
    setTimeout(() => { document.getElementById('settingsMenu').classList.add('open'); }, 10);
    dragElement(document.getElementById('settingsMenu'));
  }

  function renderSettings() {
    var t = translations[currentLanguage];
    var currentScale = localStorage.getItem('uiScale') || '1';
    var content = '<h3>' + t.settingsTitle + '</h3>';
    content += '<label for="uiScale">' + t.uiScaleLabel + '</label><br>';
    content += '<select id="uiScale">';
    content += '<option value="0.8"' + (currentScale === '0.8' ? ' selected' : '') + '>' + t.smallScale + '</option>';
    content += '<option value="1"' + (currentScale === '1' ? ' selected' : '') + '>' + t.mediumScale + '</option>';
    content += '<option value="1.2"' + (currentScale === '1.2' ? ' selected' : '') + '>' + t.largeScale + '</option>';
    content += '</select><br>';
    content += '<label for="languageSelect">' + t.languageLabel + '</label><br>';
    content += '<select id="languageSelect">';
    content += '<option value="ru"' + (currentLanguage === 'ru' ? ' selected' : '') + '>' + t.russian + '</option>';
    content += '<option value="en"' + (currentLanguage === 'en' ? ' selected' : '') + '>' + t.english + '</option>';
    content += '<option value="uk"' + (currentLanguage === 'uk' ? ' selected' : '') + '>' + t.ukrainian + '</option>';
    content += '</select><br>';
    content += '<button onclick="applySettings()">' + t.apply + '</button><br>';
    content += '<button onclick="closeSettings()">' + t.close + '</button>';
    document.getElementById('settingsMenu').innerHTML = content;
  }

  function applySettings() {
    var scale = document.getElementById('uiScale').value;
    localStorage.setItem('uiScale', scale);
    document.body.style.transform = `scale(${scale})`;
    document.body.style.width = `${100 / parseFloat(scale)}%`;
    document.body.style.height = `${100 / parseFloat(scale)}%`;

    var lang = document.getElementById('languageSelect').value;
    setLanguage(lang);
    closeSettings();
  }

  function closeSettings() {
    document.getElementById('settingsMenu').classList.remove('open');
    setTimeout(() => { document.getElementById('settingsMenu').style.display = 'none'; }, 500);
  }

  // Update quest descriptions
  updateQuestDescriptions();

  window.onbeforeunload = async function() {
    if (currentUsername && !isDemo) {
      await update(ref(db, 'users/' + currentUid), {
        count: count,
        money: money,
        level: internal_level
      });
    }
  };

  // Make all necessary functions global for inline onclick
  window.checkKey = checkKey;
  window.enterDemoMode = enterDemoMode;
  window.showRegister = showRegister;
  window.showLogin = showLogin;
  window.showShop = showShop;
  window.showInventory = showInventory;
  window.showQuests = showQuests;
  window.showAchievements = showAchievements;
  window.showPromo = showPromo;
  window.doLogout = doLogout;
  window.resumeGame = resumeGame;
  window.showSettings = showSettings;
  window.buySmallCookie = buySmallCookie;
  window.buyMediumCookie = buyMediumCookie;
  window.buyLargeCookie = buyLargeCookie;
  window.equipSmallCookie = equipSmallCookie;
  window.unequipSmallCookie = unequipSmallCookie;
  window.equipMediumCookie = equipMediumCookie;
  window.unequipMediumCookie = unequipMediumCookie;
  window.equipLargeCookie = equipLargeCookie;
  window.unequipLargeCookie = unequipLargeCookie;
  window.closeShop = closeShop;
  window.closeInventory = closeInventory;
  window.closeAchievements = closeAchievements;
  window.closePromo = closePromo;
  window.closeQuests = closeQuests;
  window.takeQuest = takeQuest;
  window.cancelQuest = cancelQuest;
  window.showAdminPanel = showAdminPanel;
  window.blockAccount = blockAccount;
  window.unblockAccount = unblockAccount;
  window.resetCount = resetCount;
  window.showIssueClicks = showIssueClicks;
  window.showIssueCookie = showIssueCookie;
  window.showIssueAchievement = showIssueAchievement;
  window.confirmIssueClicks = confirmIssueClicks;
  window.confirmIssueCookie = confirmIssueCookie;
  window.confirmIssueAchievement = confirmIssueAchievement;
  window.closeIssueClicks = closeIssueClicks;
  window.closeIssueCookie = closeIssueCookie;
  window.closeIssueAchievement = closeIssueAchievement;
  window.closeAdminPanel = closeAdminPanel;
  window.toggleConsole = toggleConsole;
  window.executeConsoleCommand = executeConsoleCommand;
  window.closeConsole = closeConsole;
  window.applySettings = applySettings;
  window.closeSettings = closeSettings;
  window.redeemPromo = redeemPromo;
  window.init = init;
</script>
</head>
<body onload="init();">
  <div id="keyContainer" class="container">
    <h2 id="enterKeyTitle"></h2>
    <input type="text" id="inputText" placeholder=""><br><br>
    <button id="submitKeyButton" onclick="checkKey()"></button><br><br>
    <button id="exitKeyButton" onclick="window.close()"></button>
    <div id="demoContainer" style="position: absolute; bottom: 20px; left: 20px;">
      <button id="demoModeButton" onclick="enterDemoMode()"></button>
    </div>
  </div>

  <div class="container" id="authContainer" style="display:none;">
    <!-- Ð’Ñ…Ð¾Ð´ -->
    <div id="loginScreen">
      <h3 id="loginTitle"></h3>
      <input id="loginUsername" type="text" placeholder="" />
      <input id="loginPassword" type="password" placeholder="" />
      <div>
        <button id="loginButton" onclick="doLogin()"></button>
      </div>
      <div style="margin-top:10px;">
        <span id="noAccountText"></span> <button class="link-button" id="registerLink" onclick="showRegister()"></button>
      </div>
      <div id="loginMsg"></div>
    </div>

    <!-- Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ -->
    <div id="registerScreen" style="display:none;">
      <h3 id="registerTitle"></h3>
      <input id="regUsername" type="text" placeholder="" />
      <input id="regPassword" type="password" placeholder="" />
      <div>
        <button id="registerButton" onclick="doRegister()"></button>
        <button id="backButton" onclick="showLogin()"></button>
      </div>
      <div id="registerMsg"></div>
    </div>
  </div>

  <div id="loadingScreen" style="display:none;">
    <h2 id="loadingText"></h2>
  </div>

  <div id="gameScreen" style="display:none;">
    <button id="shopButton" onclick="showShop()"></button>
    <button id="inventoryButton" onclick="showInventory()"></button>
    <button id="questsButton" onclick="showQuests()"></button>
    <h2 id="level"></h2>
    <h2 id="counter"></h2>
    <h2 id="money"></h2>
    <button id="clickButton" onclick="increment()"></button>
    <button id="achievementsButton" onclick="showAchievements()"></button>
    <button id="promoButton" onclick="showPromo()"></button>
    <button id="exitButton" onclick="doLogout()"></button>
    <p id="currentQuest"></p>
  </div>

  <div id="shopMenu">
    <!-- Dynamic content will be inserted here -->
  </div>

  <div id="inventoryMenu">
    <!-- Dynamic content will be inserted here -->
  </div>

  <div id="adminMenu">
    <!-- Dynamic content will be inserted here -->
  </div>

  <div id="issueClicksMenu">
    <!-- Dynamic content will be inserted here -->
  </div>

  <div id="issueCookieMenu">
    <!-- Dynamic content will be inserted here -->
  </div>

  <div id="issueAchievementMenu">
    <!-- Dynamic content will be inserted here -->
  </div>

  <div id="blockedMenu">
    <!-- Dynamic content will be inserted here -->
  </div>

  <div id="achievementsMenu">
    <!-- Dynamic content will be inserted here -->
  </div>

  <div id="promoMenu">
    <!-- Dynamic content will be inserted here -->
  </div>

  <div id="demoExpiredMenu">
    <!-- Dynamic content will be inserted here -->
  </div>

  <div id="consoleMenu">
    <!-- Dynamic content will be inserted here -->
  </div>

  <div id="questsMenu">
    <!-- Dynamic content will be inserted here -->
  </div>

  <div id="settingsMenu">
    <!-- Dynamic content will be inserted here -->
  </div>

  <div id="pauseOverlay">
    <div id="pauseMenu">
      <h3 id="pauseTitle"></h3>
      <button id="resumeButton" onclick="resumeGame()"></button>
      <button id="settingsButton" onclick="showSettings()"></button>
      <button id="logoutButton" onclick="doLogout()"></button>
    </div>
  </div>

</body>
</html>
